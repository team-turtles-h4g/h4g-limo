(self.webpackChunkh4g_limo=self.webpackChunkh4g_limo||[]).push([[9306],{59306:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>g});var r=i(16304),n=i(2747),s=i(18419),l=i(54704),o=i(35718),a=i(2266),u=i(55278),c=i(32931),f=i(77270),h=i(65669),p=i(89312);const d=s.Z.getLogger("esri.views.2d.layers.features.support.whereUtils"),y={getAttribute:(e,t)=>e.field(t)};function m(){return(m=(0,r.Z)(function*(e,t){const r=yield i.e(8612).then(i.bind(i,18612));try{const i=r.WhereClause.create(e,t);if(!i.isStandardized){const e=new n.Z("mapview - bad input","Unable to apply filter's definition expression, as expression is not standardized.",i);d.error(e)}return e=>{const t=e.readArcadeFeature();return i.testFeature(t,y)}}catch(s){return d.warn("mapview-bad-where-clause","Encountered an error when evaluating where clause",e),e=>!0}})).apply(this,arguments)}const _=s.Z.getLogger("esri.views.2d.layers.features.controllers.FeatureFilter");class g{constructor(e){this._geometryBounds=(0,o.Ue)(),this._idToVisibility=new Map,this._serviceInfo=e}get hash(){return this._hash}check(e){return this._applyFilter(e)}clear(){const e=this._resetAllHiddenIds();return this.update(),{show:e,hide:[]}}invalidate(){this._idToVisibility.forEach((e,t)=>{this._idToVisibility.set(t,0)})}setKnownIds(e){for(const t of e)this._idToVisibility.set(t,1)}setTrue(e){const t=[],i=[],r=new Set(e);return this._idToVisibility.forEach((e,n)=>{const s=!!(1&this._idToVisibility.get(n)),l=r.has(n);!s&&l?t.push(n):s&&!l&&i.push(n),this._idToVisibility.set(n,l?3:0)}),{show:t,hide:i}}createQuery(){const{geometry:e,spatialRel:t,where:i,timeExtent:r,objectIds:n}=this;return h.Z.fromJSON({geometry:e,spatialRel:t,where:i,timeExtent:r,objectIds:n})}update(e,t){var i=this;return(0,r.Z)(function*(){i._hash=JSON.stringify(e);const r=yield(0,f.j6)(e,null,t);yield Promise.all([i._setGeometryFilter(r),i._setIdFilter(r),i._setAttributeFilter(r),i._setTimeFilter(r)])})()}_setAttributeFilter(e){var t=this;return(0,r.Z)(function*(){if(!e||!e.where)return t._clause=null,void(t.where=null);t._clause=yield function(e,t){return m.apply(this,arguments)}(e.where,t._serviceInfo.fieldsIndex),t.where=e.where})()}_setIdFilter(e){this._idsToShow=e&&e.objectIds&&new Set(e.objectIds),this._idsToHide=e&&e.hiddenIds&&new Set(e.hiddenIds),this.objectIds=e&&e.objectIds}_setGeometryFilter(e){var t=this;return(0,r.Z)(function*(){if(!e||!e.geometry)return t._spatialQueryOperator=null,t.geometry=null,void(t.spatialRel=null);const i=e.geometry,r=e.spatialRel||"esriSpatialRelIntersects",n=yield(0,u.cW)(r,i,t._serviceInfo.geometryType,t._serviceInfo.hasZ,t._serviceInfo.hasM);(0,a.$P)(t._geometryBounds,i),t._spatialQueryOperator=n,t.geometry=i,t.spatialRel=r})()}_setTimeFilter(e){if(this.timeExtent=this._timeOperator=null,e&&e.timeExtent)if(this._serviceInfo.timeInfo)this.timeExtent=e.timeExtent,this._timeOperator=(0,c.y)(this._serviceInfo.timeInfo,e.timeExtent,p.k);else{const t=new n.Z("feature-layer-view:time-filter-not-available","Unable to apply time filter, as layer doesn't have time metadata.",e.timeExtent);_.error(t)}}_applyFilter(e){return this._filterByGeometry(e)&&this._filterById(e)&&this._filterByTime(e)&&this._filterByExpression(e)}_filterByExpression(e){return!this.where||this._clause(e)}_filterById(e){return(!this._idsToHide||!this._idsToHide.size||!this._idsToHide.has(e.getObjectId()))&&(!this._idsToShow||!this._idsToShow.size||this._idsToShow.has(e.getObjectId()))}_filterByGeometry(e){if(!this.geometry)return!0;const t=e.readHydratedGeometry();return!!t&&this._spatialQueryOperator(t)}_filterByTime(e){return!(0,l.pC)(this._timeOperator)||this._timeOperator(e)}_resetAllHiddenIds(){const e=[];return this._idToVisibility.forEach((t,i)=>{1&t||(this._idToVisibility.set(i,1),e.push(i))}),e}}},55278:(e,t,i)=>{"use strict";i.d(t,{hN:()=>G,P0:()=>F,cW:()=>T});var r=i(16304),n=i(2747),s=i(61182),l=i(23469),o=i(60337),a=i(73507);function u(e,t){return e?t?4:3:t?3:2}function c(e,t,i,r,n,s){const l=u(n,s),{coords:o,lengths:a}=r;if(!a)return!1;for(let u=0,c=0;u<a.length;u++,c+=l)if(!f(e,t,i,o[c],o[c+1]))return!1;return!0}function f(e,t,i,r,n){if(!e)return!1;const s=u(t,i),{coords:l,lengths:o}=e;let a=!1,c=0;for(const u of o)a=h(a,l,s,c,u,r,n),c+=u*s;return a}function h(e,t,i,r,n,s,l){let o=e,a=r;for(let u=r,c=r+n*i;u<c;u+=i){a=u+i,a===c&&(a=r);const e=t[u],n=t[u+1],f=t[a],h=t[a+1];(n<l&&h>=l||h<l&&n>=l)&&e+(l-n)/(h-n)*(f-e)<s&&(o=!o)}return o}var p=i(41801),d=i(99867),y=i(95876),m=i(77270);const _="feature-store:unsupported-query",g={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:null},S={esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},R={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},w={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1};function I(e){return!0===S[e]}function b(e){return!0===R[(0,o.Ji)(e)]}function v(e){return!0===w[e]}function T(e,t,r,n,a){if((0,o.oU)(t)&&"esriGeometryPoint"===r&&("esriSpatialRelIntersects"===e||"esriSpatialRelContains"===e)){const e=(0,p.Uy)(new d.Z,t,!1,!1);return Promise.resolve(t=>function(e,t,i,r){return f(e,!1,!1,r.coords[0],r.coords[1])}(e,0,0,t))}if((0,o.oU)(t)&&"esriGeometryMultipoint"===r){const i=(0,p.Uy)(new d.Z,t,!1,!1);if("esriSpatialRelContains"===e)return Promise.resolve(e=>c(i,!1,!1,e,n,a))}if((0,o.YX)(t)&&"esriGeometryPoint"===r&&("esriSpatialRelIntersects"===e||"esriSpatialRelContains"===e))return Promise.resolve(e=>(0,s.aV)(t,(0,m.Op)(r,n,a,e)));if((0,o.YX)(t)&&"esriGeometryMultipoint"===r&&"esriSpatialRelContains"===e)return Promise.resolve(e=>(0,s.lQ)(t,(0,m.Op)(r,n,a,e)));if((0,o.YX)(t)&&"esriSpatialRelIntersects"===e){const e=function(e){return"mesh"===e?l.h_:(0,l.IY)(e)}(r);return Promise.resolve(i=>e(t,(0,m.Op)(r,n,a,i)))}return Promise.all([i.e(9677),i.e(8592),i.e(9899)]).then(i.bind(i,29899)).then(i=>{const s=i[g[e]].bind(null,t.spatialReference,t);return e=>s((0,m.Op)(r,n,a,e))})}function F(e,t,i){return Z.apply(this,arguments)}function Z(){return(Z=(0,r.Z)(function*(e,t,i){const{spatialRel:r,geometry:s}=e;if(s){if(!I(r))throw new n.Z(_,"Unsupported query spatial relationship",{query:e});if((0,a.JY)(s.spatialReference)&&(0,a.JY)(i)){if(!b(s))throw new n.Z(_,"Unsupported query geometry type",{query:e});if(!v(t))throw new n.Z(_,"Unsupported layer geometry type",{query:e});if(e.outSR)return(0,y._W)(e.geometry&&e.geometry.spatialReference,e.outSR)}}})).apply(this,arguments)}function G(e){if((0,o.YX)(e))return!0;if((0,o.oU)(e)){for(const t of e.rings){if(5!==t.length)return!1;if(t[0][0]!==t[1][0]||t[0][0]!==t[4][0]||t[2][0]!==t[3][0]||t[0][1]!==t[3][1]||t[0][1]!==t[4][1]||t[1][1]!==t[2][1])return!1}return!0}return!1}},32931:(e,t,i)=>{"use strict";function r(e,t){if(!e)return null;const i=t.featureAdapter,{startTimeField:r,endTimeField:n}=e;let s=Number.POSITIVE_INFINITY,l=Number.NEGATIVE_INFINITY;if(r&&n)t.forEach(e=>{const t=i.getAttribute(e,r),o=i.getAttribute(e,n);null==t||isNaN(t)||(s=Math.min(s,t)),null==o||isNaN(o)||(l=Math.max(l,o))});else{const e=r||n;t.forEach(t=>{const r=i.getAttribute(t,e);null==r||isNaN(r)||(s=Math.min(s,r),l=Math.max(l,r))})}return{start:s,end:l}}function n(e,t,i){if(!t||!e)return null;const{startTimeField:r,endTimeField:n}=e;if(!r&&!n)return null;const{start:s,end:l}=t;return null===s&&null===l?null:void 0===s&&void 0===l?()=>!1:r&&n?function(e,t,i,r,n){return null!=r&&null!=n?s=>{const l=e.getAttribute(s,t),o=e.getAttribute(s,i);return(null==l||l<=n)&&(null==o||o>=r)}:null!=r?t=>{const n=e.getAttribute(t,i);return null==n||n>=r}:null!=n?i=>{const r=e.getAttribute(i,t);return null==r||r<=n}:void 0}(i,r,n,s,l):function(e,t,i,r){return null!=i&&null!=r&&i===r?r=>e.getAttribute(r,t)===i:null!=i&&null!=r?n=>{const s=e.getAttribute(n,t);return s>=i&&s<=r}:null!=i?r=>e.getAttribute(r,t)>=i:null!=r?i=>e.getAttribute(i,t)<=r:void 0}(i,r||n,s,l)}i.d(t,{R:()=>r,y:()=>n})},77270:(e,t,i)=>{"use strict";i.d(t,{vF:()=>y,S2:()=>N,Op:()=>w,Up:()=>I,j6:()=>v,EG:()=>R});var r=i(16304),n=i(5902),s=i(54704),l=i(43899),o=i(62786),a=i(60337),u=i(11909),c=i(73507),f=i(41801),h=i(99867),p=i(95876);const d=new n.Xn({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),y=Object.freeze({}),m=new h.Z,_=new h.Z,g=new h.Z,S={esriGeometryPoint:f.fQ,esriGeometryPolyline:f.J6,esriGeometryPolygon:f.eG,esriGeometryMultipoint:f.Iv};function R(e,t,i,r=e.hasZ,n=e.hasM){if((0,s.Wi)(t))return null;const l=e.hasZ&&r,o=e.hasM&&n;if(i){const s=(0,f.Nh)(g,t,e.hasZ,e.hasM,"esriGeometryPoint",i,r,n);return(0,f.fQ)(s,l,o)}return(0,f.fQ)(t,l,o)}function w(e,t,i,r,n,l,o=t,a=i){const u=t&&o,c=i&&a,h=(0,s.pC)(r)?"coords"in r?r:r.geometry:null;if((0,s.Wi)(h))return null;if(n){let r=(0,f.zj)(_,h,t,i,e,n,o,a);return l&&(r=(0,f.Nh)(g,r,u,c,e,l)),S[e](r,u,c)}if(l){const r=(0,f.Nh)(g,h,t,i,e,l,o,a);return S[e](r,u,c)}return(0,f.hY)(m,h,t,i,o,a),S[e](m,u,c)}function I(e,t,i){return b.apply(this,arguments)}function b(){return(b=(0,r.Z)(function*(e,t,i){const{outFields:r,orderByFields:n,groupByFieldsForStatistics:s,outStatistics:l}=e;if(r)for(let o=0;o<r.length;o++)r[o]=r[o].trim();if(n)for(let o=0;o<n.length;o++)n[o]=n[o].trim();if(s)for(let o=0;o<s.length;o++)s[o]=s[o].trim();if(l)for(let o=0;o<l.length;o++)l[o].onStatisticField&&(l[o].onStatisticField=l[o].onStatisticField.trim());return e.geometry&&!e.outSR&&(e.outSR=e.geometry.spatialReference),v(e,t,i)})).apply(this,arguments)}function v(e,t,i){return T.apply(this,arguments)}function T(){return(T=(0,r.Z)(function*(e,t,i){if(!e)return null;let{where:r}=e;if(e.where=r=r&&r.trim(),(!r||/^1 *= *1$/.test(r)||t&&t===r)&&(e.where=null),!e.geometry)return e;let n=yield F(e);if(e.distance=0,e.units=null,"esriSpatialRelEnvelopeIntersects"===e.spatialRel){const{spatialReference:t}=e.geometry;n=(0,o.aO)(n),n.spatialReference=t}e.geometry=n,yield(0,p._W)(n.spatialReference,i);const l=(yield(0,u.aX)((0,a.im)(n)))[0];if((0,s.Wi)(l))throw y;const c=l.toJSON(),f=yield(0,p.iV)(c,c.spatialReference,i);if(!f)throw y;return f.spatialReference=i,e.geometry=f,e})).apply(this,arguments)}function F(e){return Z.apply(this,arguments)}function Z(){return(Z=(0,r.Z)(function*(e){const{geometry:t,distance:i,units:r}=e;if(null==i||"vertexAttributes"in t)return t;const n=t.spatialReference,s=r?d.fromJSON(r):(0,l.qE)(n),o=n&&((0,c.sT)(n)||(0,c.sS)(n))?t:yield(0,p._W)(n,c.Zn).then(()=>(0,p.iV)(t,c.Zn));return(yield G())(o.spatialReference,o,i,s)})).apply(this,arguments)}function G(){return E.apply(this,arguments)}function E(){return(E=(0,r.Z)(function*(){return(yield Promise.all([i.e(9677),i.e(8592),i.e(9899)]).then(i.bind(i,29899))).geodesicBuffer})).apply(this,arguments)}function N(e){return e&&O in e?JSON.parse(JSON.stringify(e,P)):e}const O="_geVersion",P=(e,t)=>e!==O?t:void 0}}]);