(self.webpackChunkh4g_limo=self.webpackChunkh4g_limo||[]).push([[9017],{69017:(e,i,s)=>{"use strict";s.r(i),s.d(i,{default:()=>V});var t=s(16304),r=s(8651),a=s(4706),n=s(42961),h=s(54704),o=s(72147),l=(s(46942),s(12131),s(47648),s(18419),s(8680)),p=s(67692),c=s(64713),u=s(61789),d=s(93729);const g="sublayers",f="layerView",w=Object.freeze({remove(){},pause(){},resume(){}});let y=class extends((0,p.y)(d.Z)){fetchPopupFeatures(e){var i=this;return(0,t.Z)(function*(){return(yield Promise.all(Array.from(i.graphicsViews(),i=>i.searchFeatures(e).then(e=>e.filter(e=>!!e.popupTemplate))))).flat()})()}*graphicsViews(){(0,h.pC)(this._graphicsViewsFeatureCollectionMap)?yield*this._graphicsViewsFeatureCollectionMap.keys():(0,h.pC)(this._graphicsViews)?yield*this._graphicsViews:yield*[]}hitTest(e,i){var s=this;return(0,t.Z)(function*(){if(s.suspended)return null;const r=Array.from(s.graphicsViews(),function(){var r=(0,t.Z)(function*(t){const r=yield t.hitTest(e,i);if(r){if((0,h.pC)(s._graphicsViewsFeatureCollectionMap)){const e=s._graphicsViewsFeatureCollectionMap.get(t);!r.popupTemplate&&e.popupTemplate&&(r.popupTemplate=e.popupTemplate)}return r}return null});return function(e){return r.apply(this,arguments)}}());return(yield Promise.all(r)).filter(e=>!!e)[0]||null})()}highlight(e){let i;if("number"==typeof e?i=[e]:e instanceof a.Z?i=[e.uid]:Array.isArray(e)&&e.length>0?i="number"==typeof e[0]?e:e.map(e=>e&&e.uid):n.Z.isCollection(e)&&(i=e.map(e=>e&&e.uid).toArray()),i=i.filter(e=>null!=e),!i.length)return w;for(const s of this.graphicsViews())s.addHighlight(i);return{remove:()=>{for(const e of this.graphicsViews())e.removeHighlight(i)}}}update(e){for(const i of this.graphicsViews())i.processUpdate(e)}attach(){const e=this.view,i=()=>this.requestUpdate(),s=this.layer.featureCollections;if((0,h.pC)(s)&&s.length){this._graphicsViewsFeatureCollectionMap=new Map;for(const t of s){const s=new c.Z(this.view.featuresTilingScheme);s.fadeTransitionEnabled=!0;const r=new u.Z({view:e,graphics:t.source,renderer:t.renderer,requestUpdateCallback:i,container:s});this._graphicsViewsFeatureCollectionMap.set(r,t),this.container.addChild(r.container),this.handles.add([(0,o.S1)(t,"visible",e=>r.container.visible=e),(0,o.S1)(r,"updating",()=>this.notifyChange("updating"))],f)}}else(0,h.pC)(this.layer.sublayers)&&this.handles.add((0,o.on)(this.layer,"sublayers","change",()=>this._createGraphicsViews(),()=>this._createGraphicsViews(),()=>this._destroyGraphicsViews()),g)}detach(){this._destroyGraphicsViews(),this.handles.remove(g)}moveStart(){}moveEnd(){}viewChange(){for(const e of this.graphicsViews())e.viewChange()}isUpdating(){for(const e of this.graphicsViews())if(e.updating)return!0;return!1}_destroyGraphicsViews(){this.container.removeAllChildren(),this.handles.remove(f);for(const e of this.graphicsViews())e.destroy();this._graphicsViews=null,this._graphicsViewsFeatureCollectionMap=null}_createGraphicsViews(){if(this._destroyGraphicsViews(),(0,h.Wi)(this.layer.sublayers))return;const e=[],i=this.view,s=()=>this.requestUpdate();for(const t of this.layer.sublayers){const r=new c.Z(this.view.featuresTilingScheme);r.fadeTransitionEnabled=!0;const a=new u.Z({view:i,graphics:t.graphics,requestUpdateCallback:s,container:r});this.handles.add([t.on("graphic-update",a.graphicUpdateHandler),(0,o.S1)(t,"visible",e=>a.container.visible=e),(0,o.S1)(a,"updating",()=>this.notifyChange("updating"))],f),this.container.addChild(a.container),e.push(a)}this._graphicsViews=e}};y=(0,r._)([(0,l.j)("esri.views.2d.layers.MapNotesLayerView2D")],y);var V=y}}]);