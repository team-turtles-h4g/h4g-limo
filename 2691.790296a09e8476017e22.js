(self.webpackChunkh4g_limo=self.webpackChunkh4g_limo||[]).push([[2691],{12691:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>P});var s,l=r(16304),i=r(8651),o=(r(42851),r(42961)),a=r(27338),n=r(54704),u=r(67372),y=r(98154),h=r(57319),p=r(46942),b=(r(12131),r(47648)),d=(r(18419),r(41460)),c=r(8680),v=r(66081),_=r(2379),f=r(3523),C=r(68141),g=r(83727),S=r(20174),m=r(69265),w=r(37001),E=r(17788),k=r(70222),x=r(49533),L=r(45581),O=r(36434),F=r(72147),Z=r(38062),j=r(62775),M=r(95046);let I=s=class extends(k.Z.EventedMixin((0,x.eC)(L.Z))){constructor(){super(...arguments),this._sublayersHandles=null,this.description=null,this.id=null,this.networkLink=null,this.title=null,this.sourceJSON=null,this.fullExtent=null}initialize(){(0,F.N1)(this,"networkLink").then(()=>(0,F.LR)(this,"visible")).then(()=>this.load())}load(e){if(!this.networkLink)return;if(this.networkLink.viewFormat)return;const t=(0,n.pC)(e)?e.signal:null,r=this._fetchService(this._get("networkLink").href,t).then(e=>{const t=(0,j.lm)(e.sublayers);this.fullExtent=M.Z.fromJSON(t),this.sourceJSON=e;const r=(0,b.se)(o.Z.ofType(s),(0,j.j5)(s,e));this.sublayers?this.sublayers.addMany(r):this.sublayers=r,this.layer.emit("sublayer-update"),this.layer&&this.layer.notifyChange("visibleSublayers")});return this.addResolvingPromise(r),Promise.resolve(this)}set sublayers(e){const t=this._get("sublayers");t&&(t.forEach(e=>{e.parent=null,e.layer=null}),this._sublayersHandles.forEach(e=>e.remove()),this._sublayersHandles=null),e&&(e.forEach(e=>{e.parent=this,e.layer=this.layer}),this._sublayersHandles=[e.on("after-add",({item:e})=>{e.parent=this,e.layer=this.layer}),e.on("after-remove",({item:e})=>{e.parent=null,e.layer=null})]),this._set("sublayers",e)}castSublayers(e){return(0,b.se)(o.Z.ofType(s),e)}get visible(){return this._get("visible")}set visible(e){this._get("visible")!==e&&(this._set("visible",e),this.layer&&this.layer.notifyChange("visibleSublayers"))}readVisible(e,t){return!!t.visibility}set layer(e){this._set("layer",e),this.sublayers&&this.sublayers.forEach(t=>t.layer=e)}_fetchService(e,t){return(0,j.CS)(e,this.layer.outSpatialReference,this.layer.refreshInterval,t).then(e=>(0,j.Cw)(e.data))}};(0,i._)([(0,p.Cb)()],I.prototype,"description",void 0),(0,i._)([(0,p.Cb)()],I.prototype,"id",void 0),(0,i._)([(0,p.Cb)({readOnly:!0,value:null})],I.prototype,"networkLink",void 0),(0,i._)([(0,p.Cb)({json:{write:{allowNull:!0}}})],I.prototype,"parent",void 0),(0,i._)([(0,p.Cb)({value:null,json:{write:{allowNull:!0}}})],I.prototype,"sublayers",null),(0,i._)([(0,Z.p)("sublayers")],I.prototype,"castSublayers",null),(0,i._)([(0,p.Cb)({value:null,json:{read:{source:"name",reader:e=>(0,O.Cb)(e)}}})],I.prototype,"title",void 0),(0,i._)([(0,p.Cb)({value:!0})],I.prototype,"visible",null),(0,i._)([(0,d.r)("visible",["visibility"])],I.prototype,"readVisible",null),(0,i._)([(0,p.Cb)()],I.prototype,"sourceJSON",void 0),(0,i._)([(0,p.Cb)({value:null})],I.prototype,"layer",null),(0,i._)([(0,p.Cb)({type:M.Z})],I.prototype,"fullExtent",void 0),I=s=(0,i._)([(0,c.j)("esri.layers.support.KMLSublayer")],I);var R=I;const N=["kml","xml"];let K=class extends((0,C.h)((0,m.Q)((0,w.M)((0,g.q)((0,S.I)((0,u.R)(f.Z))))))){constructor(...e){super(...e),this._visibleFolders=[],this.allSublayers=new a.Z({getCollections:()=>[this.sublayers],getChildrenFunction:e=>e.sublayers}),this.outSpatialReference=_.Z.WGS84,this.path=null,this.legendEnabled=!1,this.operationalLayerType="KML",this.sublayers=null,this.type="kml",this.url=null}initialize(){this.watch("sublayers",(e,t)=>{t&&t.forEach(e=>{e.parent=null,e.layer=null}),e&&e.forEach(e=>{e.parent=this,e.layer=this})},!0),this.on("sublayer-update",()=>this.notifyChange("fullExtent"))}normalizeCtorArgs(e,t){return"string"==typeof e?{url:e,...t}:e}readSublayersFromItemOrWebMap(e,t){this._visibleFolders=t.visibleFolders}readSublayers(e,t,r){return(0,j.j5)(R,t,r,this._visibleFolders)}writeSublayers(e,t){const r=[],s=e.toArray();for(;s.length;){const e=s[0];e.networkLink||(e.visible&&r.push(e.id),e.sublayers&&s.push(...e.sublayers.toArray())),s.shift()}t.visibleFolders=r}get title(){const e=this._get("title");return e&&"defaults"!==this.originOf("title")?e:this.url?(0,h.vt)(this.url,N)||"KML":e||""}set title(e){this._set("title",e)}get visibleSublayers(){const e=this.sublayers,t=[],r=e=>{e.visible&&(t.push(e),e.sublayers&&e.sublayers.forEach(r))};return e&&e.forEach(r),t}get fullExtent(){return this._recomputeFullExtent()}load(e){const t=(0,n.pC)(e)?e.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["KML"]},e).catch(y.r9).then(()=>this._fetchService(t))),Promise.resolve(this)}destroy(){super.destroy(),this.allSublayers.destroy()}_fetchService(e){var t=this;return(0,l.Z)(function*(){const r=yield Promise.resolve().then(()=>t.resourceInfo?{ssl:!1,data:t.resourceInfo}:(0,j.CS)(t.url,t.outSpatialReference,t.refreshInterval,e)),s=(0,j.Cw)(r.data);s&&t.read(s,{origin:"service"})})()}_recomputeFullExtent(){let e=null;this.extent&&(e=this.extent.clone());const t=r=>{if(r.sublayers)for(const s of r.sublayers.items)t(s),s.visible&&s.fullExtent&&(e?e.union(s.fullExtent):e=s.fullExtent.clone())};return t(this),e}};(0,i._)([(0,p.Cb)({readOnly:!0})],K.prototype,"allSublayers",void 0),(0,i._)([(0,p.Cb)({type:_.Z})],K.prototype,"outSpatialReference",void 0),(0,i._)([(0,p.Cb)({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],K.prototype,"path",void 0),(0,i._)([(0,p.Cb)({readOnly:!0,json:{read:!1,write:!1}})],K.prototype,"legendEnabled",void 0),(0,i._)([(0,p.Cb)({type:["show","hide","hide-children"]})],K.prototype,"listMode",void 0),(0,i._)([(0,p.Cb)({type:["KML"]})],K.prototype,"operationalLayerType",void 0),(0,i._)([(0,p.Cb)({})],K.prototype,"resourceInfo",void 0),(0,i._)([(0,p.Cb)({type:o.Z.ofType(R),json:{write:{ignoreOrigin:!0}}})],K.prototype,"sublayers",void 0),(0,i._)([(0,d.r)(["web-map","portal-item"],"sublayers",["visibleFolders"])],K.prototype,"readSublayersFromItemOrWebMap",null),(0,i._)([(0,d.r)("service","sublayers",["sublayers"])],K.prototype,"readSublayers",null),(0,i._)([(0,v.c)("sublayers")],K.prototype,"writeSublayers",null),(0,i._)([(0,p.Cb)({readOnly:!0,json:{read:!1}})],K.prototype,"type",void 0),(0,i._)([(0,p.Cb)({json:{origins:{"web-map":{read:{source:"title"}}},write:{ignoreOrigin:!0}}})],K.prototype,"title",null),(0,i._)([(0,p.Cb)(E.HQ)],K.prototype,"url",void 0),(0,i._)([(0,p.Cb)({readOnly:!0})],K.prototype,"visibleSublayers",null),(0,i._)([(0,p.Cb)({type:M.Z})],K.prototype,"extent",void 0),(0,i._)([(0,p.Cb)()],K.prototype,"fullExtent",null),K=(0,i._)([(0,c.j)("esri.layers.KMLLayer")],K);var P=K}}]);