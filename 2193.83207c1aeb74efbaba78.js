(self.webpackChunkh4g_limo=self.webpackChunkh4g_limo||[]).push([[2193],{22193:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>B});var i=r(16304),o=r(8651),l=(r(42851),r(4706)),a=(r(75737),r(42961)),n=r(2747),s=r(69141),y=r(54704),p=r(67372),u=r(27616),d=r(3257),c=r(46942),m=(r(47648),r(12131),r(18419),r(41460)),f=r(8680),b=r(66081),h=r(90626),g=r(11909),S=r(73507),v=r(76468),C=r(3523),w=r(68141),O=r(37001),_=r(34430),N=r(55146);let J=class extends((0,w.h)((0,O.M)(C.Z))){constructor(e){super(e),this.elevationInfo=null,this.graphics=new _.ZP,this.screenSizePerspectiveEnabled=!0,this.type="graphics",this.internal=!1}destroy(){this.removeAll(),this.graphics.destroy()}add(e){return this.graphics.add(e),this}addMany(e){return this.graphics.addMany(e),this}removeAll(){return this.graphics.removeAll(),this}remove(e){this.graphics.remove(e)}removeMany(e){this.graphics.removeMany(e)}on(e,t){return super.on(e,t)}graphicChanged(e){this.emit("graphic-update",e)}};(0,o._)([(0,c.Cb)({type:N.Z})],J.prototype,"elevationInfo",void 0),(0,o._)([(0,c.Cb)((0,_.$o)())],J.prototype,"graphics",void 0),(0,o._)([(0,c.Cb)({type:["show","hide"]})],J.prototype,"listMode",void 0),(0,o._)([(0,c.Cb)()],J.prototype,"screenSizePerspectiveEnabled",void 0),(0,o._)([(0,c.Cb)({readOnly:!0})],J.prototype,"type",void 0),(0,o._)([(0,c.Cb)({constructOnly:!0})],J.prototype,"internal",void 0),J=(0,o._)([(0,f.j)("esri.layers.GraphicsLayer")],J);var L=J,T=r(80973),M=r(83727),Z=r(20174),x=r(23535),I=r(64030),R=r(4659),j=r(61488),E=r(88771),D=r(2379),P=r(95046);function G(e){return e.layers.some(e=>null!=e.layerDefinition.visibilityField)}const F=new x.Z({name:"OBJECTID",alias:"OBJECTID",type:"oid",nullable:!1,editable:!1}),W=new x.Z({name:"title",alias:"Title",type:"string",nullable:!0,editable:!0});let k=class extends L{constructor(){super(...arguments),this.visibilityMode="inherited"}initialize(){for(const e of this.graphics)e.sourceLayer=this.layer;this.graphics.on("after-add",e=>{e.item.sourceLayer=this.layer}),this.graphics.on("after-remove",e=>{e.item.sourceLayer=null})}get sublayers(){return this.graphics}};(0,o._)([(0,c.Cb)({readOnly:!0})],k.prototype,"sublayers",null),(0,o._)([(0,c.Cb)()],k.prototype,"layer",void 0),(0,o._)([(0,c.Cb)({readOnly:!0})],k.prototype,"visibilityMode",void 0),k=(0,o._)([(0,f.j)("esri.layers.MapNotesLayer.MapNotesSublayer")],k);const z=[{geometryType:"polygon",geometryTypeJSON:"esriGeometryPolygon",layerId:"polygonLayer",title:"Polygons",identifyingSymbol:(new I.Z).toJSON()},{geometryType:"polyline",geometryTypeJSON:"esriGeometryPolyline",layerId:"polylineLayer",title:"Polylines",identifyingSymbol:(new R.Z).toJSON()},{geometryType:"multipoint",geometryTypeJSON:"esriGeometryMultipoint",layerId:"multipointLayer",title:"Multipoints",identifyingSymbol:(new j.Z).toJSON()},{geometryType:"point",geometryTypeJSON:"esriGeometryPoint",layerId:"pointLayer",title:"Points",identifyingSymbol:(new j.Z).toJSON()},{geometryType:"point",geometryTypeJSON:"esriGeometryPoint",layerId:"textLayer",title:"Text",identifyingSymbol:(new E.Z).toJSON()}];let A=class extends((0,w.h)((0,O.M)((0,M.q)((0,Z.I)((0,p.R)(C.Z)))))){constructor(e){super(e),this.capabilities={operations:{supportsMapNotesEditing:!0}},this.featureCollections=null,this.featureCollectionJSON=null,this.featureCollectionType="notes",this.legendEnabled=!1,this.minScale=0,this.maxScale=0,this.spatialReference=D.Z.WGS84,this.sublayers=new a.Z(z.map(e=>new k({id:e.layerId,title:e.title,layer:this}))),this.title="Map Notes",this.type="map-notes",this.visibilityMode="inherited"}readCapabilities(e,t,r){return{operations:{supportsMapNotesEditing:!G(t)&&"portal-item"!==(null==r?void 0:r.origin)}}}readFeatureCollections(e,t,r){if(!G(t))return null;const i=t.layers.map(e=>{const t=new v.default;return t.read(e,r),t});return new a.Z({items:i})}readLegacyfeatureCollectionJSON(e,t){return G(t)?(0,s.d9)(t.featureCollection):null}readFullExtent(e,t){if(!t.layers.length)return new P.Z({xmin:-180,ymin:-90,xmax:180,ymax:90,spatialReference:D.Z.WGS84});const r=D.Z.fromJSON(t.layers[0].layerDefinition.spatialReference);return t.layers.reduce((e,t)=>{const r=t.layerDefinition.extent;return r?P.Z.fromJSON(r).union(e):e},new P.Z({spatialReference:r}))}readMinScale(e,t){for(const r of t.layers)if(null!=r.layerDefinition.minScale)return r.layerDefinition.minScale;return 0}readMaxScale(e,t){for(const r of t.layers)if(null!=r.layerDefinition.maxScale)return r.layerDefinition.maxScale;return 0}get multipointLayer(){return this._findSublayer("multipointLayer")}get pointLayer(){return this._findSublayer("pointLayer")}get polygonLayer(){return this._findSublayer("polygonLayer")}get polylineLayer(){return this._findSublayer("polylineLayer")}readSpatialReference(e,t){return t.layers.length?D.Z.fromJSON(t.layers[0].layerDefinition.spatialReference):D.Z.WGS84}readSublayers(e,t,r){if(G(t))return null;const i=[];for(let a=0;a<t.layers.length;a++){var o;const{layerDefinition:e,featureSet:r}=t.layers[a],n=null!=(o=e.geometryType)?o:r.geometryType,s=z.find(t=>{var r,i,o;return n===t.geometryTypeJSON&&(null==(r=e.drawingInfo)||null==(i=r.renderer)||null==(o=i.symbol)?void 0:o.type)===t.identifyingSymbol.type});if(s){const t=new k({id:s.layerId,title:e.name,layer:this,graphics:r.features.map(({geometry:e,symbol:t,attributes:r,popupInfo:i})=>l.Z.fromJSON({attributes:r,geometry:e,symbol:t,popupTemplate:i}))});i.push(t)}}return new a.Z(i)}writeSublayers(e,t,r,i){const{minScale:o,maxScale:l}=this;if((0,y.Wi)(e))return;const a=e.some(e=>e.graphics.length>0);var s;if(!this.capabilities.operations.supportsMapNotesEditing)return void(a&&(null==i||null==(s=i.messages)||s.push(new n.Z("map-notes-layer:editing-not-supported","New map notes cannot be added to this layer"))));const p=[];let d=this.spatialReference.toJSON();e:for(const n of e)for(const e of n.graphics)if((0,y.pC)(e.geometry)){d=e.geometry.spatialReference.toJSON();break e}for(const n of z){const t=e.find(e=>n.layerId===e.id);this._writeMapNoteSublayer(p,t,n,o,l,d,i)}(0,u.RB)("featureCollection.layers",p,t)}get textLayer(){return this._findSublayer("textLayer")}load(e){return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Feature Collection"]},e)),Promise.resolve(this)}read(e,t){"featureCollection"in e&&(e=(0,s.d9)(e),Object.assign(e,e.featureCollection)),super.read(e,t)}beforeSave(){var e=this;return(0,i.Z)(function*(){if((0,y.Wi)(e.sublayers))return;let t=null;const r=[];for(const o of e.sublayers)for(const e of o.graphics)if((0,y.pC)(e.geometry)){const i=e.geometry;t?(0,S.fS)(i.spatialReference,t)||((0,h.Up)(i.spatialReference,t)||(0,h.kR)()||(yield(0,h.zD)()),e.geometry=(0,h.iV)(i,t)):t=i.spatialReference,r.push(e)}const i=yield(0,g.aX)(r.map(e=>e.geometry));r.forEach((e,t)=>e.geometry=i[t])})()}_findSublayer(e){var t,r;return(0,y.Wi)(this.sublayers)?null:null!=(t=null==(r=this.sublayers)?void 0:r.find(t=>t.id===e))?t:null}_writeMapNoteSublayer(e,t,r,i,o,l,a){const n=[];if(!(0,y.Wi)(t)){for(const e of t.graphics)this._writeMapNote(n,e,r.geometryType,a);this._normalizeObjectIds(n,F),e.push({layerDefinition:{name:t.title,drawingInfo:{renderer:{type:"simple",symbol:(0,s.d9)(r.identifyingSymbol)}},geometryType:r.geometryTypeJSON,minScale:i,maxScale:o,objectIdField:"OBJECTID",fields:[F.toJSON(),W.toJSON()],spatialReference:l},featureSet:{features:n,geometryType:r.geometryTypeJSON}})}}_writeMapNote(e,t,r,i){if((0,y.Wi)(t))return;const{geometry:o,symbol:l,popupTemplate:a}=t;if((0,y.Wi)(o))return;var n,s;if(o.type!==r)return void(null==i||null==(n=i.messages)||n.push(new d.Z("map-notes-layer:invalid-geometry-type",`Geometry "${o.type}" cannot be saved in "${r}" layer`,{graphic:t})));if((0,y.Wi)(l))return void(null==i||null==(s=i.messages)||s.push(new d.Z("map-notes-layer:no-symbol","Skipping map notes with no symbol",{graphic:t})));const p={attributes:{...t.attributes},geometry:o.toJSON(),symbol:l.toJSON()};(0,y.pC)(a)&&(p.popupInfo=a.toJSON()),e.push(p)}_normalizeObjectIds(e,t){const r=t.name;let i=(0,T.S)(r,e)+1;const o=new Set;for(const l of e){l.attributes||(l.attributes={});const{attributes:e}=l;(null==e[r]||o.has(e[r]))&&(e[r]=i++),o.add(e[r])}}};(0,o._)([(0,c.Cb)({readOnly:!0})],A.prototype,"capabilities",void 0),(0,o._)([(0,m.r)(["portal-item","web-map"],"capabilities",["layers"])],A.prototype,"readCapabilities",null),(0,o._)([(0,c.Cb)({readOnly:!0})],A.prototype,"featureCollections",void 0),(0,o._)([(0,m.r)(["web-map","portal-item"],"featureCollections",["layers"])],A.prototype,"readFeatureCollections",null),(0,o._)([(0,c.Cb)({readOnly:!0,json:{origins:{"web-map":{write:{enabled:!0,target:"featureCollection"}}}}})],A.prototype,"featureCollectionJSON",void 0),(0,o._)([(0,m.r)(["web-map","portal-item"],"featureCollectionJSON",["featureCollection"])],A.prototype,"readLegacyfeatureCollectionJSON",null),(0,o._)([(0,c.Cb)({readOnly:!0,json:{read:!1,write:{enabled:!0,ignoreOrigin:!0}}})],A.prototype,"featureCollectionType",void 0),(0,o._)([(0,c.Cb)({json:{write:!1}})],A.prototype,"fullExtent",void 0),(0,o._)([(0,m.r)(["web-map","portal-item"],"fullExtent",["layers"])],A.prototype,"readFullExtent",null),(0,o._)([(0,c.Cb)({readOnly:!0,json:{origins:{"web-map":{write:{target:"featureCollection.showLegend",overridePolicy(){return{enabled:null!=this.featureCollectionJSON}}}}}}})],A.prototype,"legendEnabled",void 0),(0,o._)([(0,c.Cb)({type:["show","hide"]})],A.prototype,"listMode",void 0),(0,o._)([(0,c.Cb)({type:Number,nonNullable:!0,json:{write:!1}})],A.prototype,"minScale",void 0),(0,o._)([(0,m.r)(["web-map","portal-item"],"minScale",["layers"])],A.prototype,"readMinScale",null),(0,o._)([(0,c.Cb)({type:Number,nonNullable:!0,json:{write:!1}})],A.prototype,"maxScale",void 0),(0,o._)([(0,m.r)(["web-map","portal-item"],"maxScale",["layers"])],A.prototype,"readMaxScale",null),(0,o._)([(0,c.Cb)({readOnly:!0})],A.prototype,"multipointLayer",null),(0,o._)([(0,c.Cb)({value:"ArcGISFeatureLayer",type:["ArcGISFeatureLayer"]})],A.prototype,"operationalLayerType",void 0),(0,o._)([(0,c.Cb)({readOnly:!0})],A.prototype,"pointLayer",null),(0,o._)([(0,c.Cb)({readOnly:!0})],A.prototype,"polygonLayer",null),(0,o._)([(0,c.Cb)({readOnly:!0})],A.prototype,"polylineLayer",null),(0,o._)([(0,c.Cb)({type:D.Z})],A.prototype,"spatialReference",void 0),(0,o._)([(0,m.r)(["web-map","portal-item"],"spatialReference",["layers"])],A.prototype,"readSpatialReference",null),(0,o._)([(0,c.Cb)({readOnly:!0,json:{origins:{"web-map":{write:{ignoreOrigin:!0}}}}})],A.prototype,"sublayers",void 0),(0,o._)([(0,m.r)("web-map","sublayers",["layers"])],A.prototype,"readSublayers",null),(0,o._)([(0,b.c)("web-map","sublayers")],A.prototype,"writeSublayers",null),(0,o._)([(0,c.Cb)({readOnly:!0})],A.prototype,"textLayer",null),(0,o._)([(0,c.Cb)()],A.prototype,"title",void 0),(0,o._)([(0,c.Cb)({readOnly:!0,json:{read:!1}})],A.prototype,"type",void 0),A=(0,o._)([(0,f.j)("esri.layers.MapNotesLayer")],A);var B=A}}]);