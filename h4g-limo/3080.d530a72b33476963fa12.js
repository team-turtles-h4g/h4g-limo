(self.webpackChunkh4g_limo=self.webpackChunkh4g_limo||[]).push([[3080],{37882:(e,t,i)=>{"use strict";i.d(t,{Z:()=>h});var s=i(12131),n=i(63054),r=i(30071),l=i(14045),a=i(81916);const o=(e,t)=>e.key.level-t.key.level!=0?e.key.level-t.key.level:e.key.row-t.key.row!=0?e.key.row-t.key.row:e.key.col-t.key.col;class h extends r.Z{constructor(e){super(),this._tileInfoView=e}get requiresDedicatedFBO(){return!1}renderChildren(e){this.sortChildren(o),this.setStencilReference(),super.renderChildren(e)}createRenderParams(e){const{state:t}=e,i=super.createRenderParams(e);return i.requiredLevel=this._tileInfoView.getClosestInfoForScale(t.scale).level,i.displayLevel=this._tileInfoView.tileInfo.scaleToZoom(t.scale),i}prepareRenderPasses(e){const t=super.prepareRenderPasses(e);return t.push(e.registerRenderPass({name:"stencil",brushes:[a.Z],drawPhase:n.jx.DEBUG|n.jx.MAP|n.jx.HIGHLIGHT,target:()=>this.getStencilTarget()})),(0,s.Z)("esri-tiles-debug")&&t.push(e.registerRenderPass({name:"tileInfo",brushes:[l.Z],drawPhase:n.jx.DEBUG,target:()=>this.children})),t}getStencilTarget(){return this.children}updateTransforms(e){for(const t of this.children){const i=this._tileInfoView.getTileResolution(t.key);t.setTransform(e,i)}}setStencilReference(){let e=1;for(const t of this.children)t.stencilRef=e++}}},50877:(e,t,i)=>{"use strict";i.d(t,{I:()=>l});var s=i(93883),n=i(66863),r=i(55757);class l extends n.s{constructor(e,t,i,s,n,l=s,a=n){super(),this.triangleCountReportedInDebug=0,this.triangleCount=0,this.texture=null,this.key=new r.Z(e),this.x=t,this.y=i,this.width=s,this.height=n,this.rangeX=l,this.rangeY=a}destroy(){this.texture&&(this.texture.dispose(),this.texture=null)}setTransform(e,t){const i=t/(e.resolution*e.pixelRatio),n=this.transforms.tileMat3,[r,l]=e.toScreenNoRotation([0,0],[this.x,this.y]);(0,s.s)(n,this.width/this.rangeX*i,0,0,0,this.height/this.rangeY*i,0,r,l,1),(0,s.m)(this.transforms.dvs,e.displayViewMat3,n)}}},9128:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>d});var s=i(8651),n=(i(46942),i(12131),i(47648),i(18419),i(8680)),r=i(17662),l=i(37012),a=i(19207);class o{constructor(){this.gradient=null,this.height=512,this.width=512}render(e){(0,r.hy)(e,512,this.intensities,this.gradient,this.minPixelIntensity,this.maxPixelIntensity)}}let h=class extends a.Z{constructor(e){super(e),this._intensityInfo={minPixelIntensity:0,maxPixelIntensity:0},this.featuresView={attributeView:{initialize:()=>{},requestUpdate:()=>{}},requestRender:()=>{}},this._container=new l.s(e.tileInfoView)}createTile(e){const t=this._container.createTile(e);return this.tileInfoView.getTileCoords(t.bitmap,e),t.bitmap.resolution=this.tileInfoView.getTileResolution(e),t}onConfigUpdate(){const e=this.layer.renderer;if("heatmap"===e.type){const{minPixelIntensity:t,maxPixelIntensity:i}=e;this._intensityInfo.minPixelIntensity=t,this._intensityInfo.maxPixelIntensity=i,this._gradient=(0,r.uI)(e.toJSON()),this.tiles.forEach(e=>{const s=e.bitmap.source;s&&(s.minPixelIntensity=t,s.maxPixelIntensity=i,s.gradient=this._gradient,e.bitmap.invalidateTexture())})}}hitTest(){return Promise.resolve([])}install(e){e.addChild(this._container)}uninstall(e){this._container.removeAllChildren(),e.removeChild(this._container)}disposeTile(e){this._container.removeChild(e),e.destroy()}supportsRenderer(e){return e&&"heatmap"===e.type}onTileData(e){const t=this.tiles.get(e.tileKey);if(!t)return;const i=e.intensityInfo,{minPixelIntensity:s,maxPixelIntensity:n}=this._intensityInfo,r=t.bitmap.source||new o;r.intensities=i&&i.matrix||null,r.minPixelIntensity=s,r.maxPixelIntensity=n,r.gradient=this._gradient,t.bitmap.source=r,this._container.addChild(t),this.requestUpdate()}onTileError(e){console.error(e)}lockGPUUploads(){}unlockGPUUploads(){}};h=(0,s._)([(0,n.j)("esri.views.2d.layers.features.tileRenderers.HeatmapTileRenderer")],h);var d=h}}]);