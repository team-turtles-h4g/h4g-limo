(self.webpackChunkh4g_limo=self.webpackChunkh4g_limo||[]).push([[8458],{58458:(e,a,t)=>{"use strict";t.r(a),t.d(a,{previewSymbol2D:()=>p});var l=t(24557),n=t(2747),s=t(85128),o=t(88880),i=t(23546),c=t(55282);const u="picture-fill",m=120,r=document.createElement("canvas");function h(e,a){const t=r.getContext("2d"),l=[];return a&&(a.weight&&l.push(a.weight),a.size&&l.push(a.size+"px"),a.family&&l.push(a.family)),t.font=l.join(" "),t.measureText(e).width}function p(e,a){var t,r;const p=null!=(null==a?void 0:a.size)?(0,s.F2)(a.size):null,d=null!=(null==a?void 0:a.maxSize)?(0,s.F2)(a.maxSize):null,f=null!=(null==a?void 0:a.opacity)?a.opacity:null,v=null!=(null==a?void 0:a.rotation)?a.rotation:"angle"in e?e.angle:null,y=(0,o._M)(e);let w=(0,o.mx)(e);if(y&&!w){const e="type"in y?null:new l.Z(y);"#ffffff"===(e?e.toHex():null)&&(w={color:"#bdc3c7",width:.75})}const g={shape:null,fill:null,stroke:w,offset:[0,0]};null!=(t=w)&&t.width&&(w.width=Math.min(w.width,80));const b=(null==(r=w)?void 0:r.width)||0;let M=null!=p&&(null==(null==a?void 0:a.scale)||(null==a?void 0:a.scale)),k=0,x=0,L=!1;switch(e.type){case"simple-marker":{const a=e.style,t=Math.min(null!=p?p:(0,s.F2)(e.size),d||m);switch(k=t,x=t,a){case"circle":g.shape={type:"circle",cx:0,cy:0,r:.5*t},M||(k+=b,x+=b);break;case"cross":g.shape={type:"path",path:[{command:"M",values:[0,.5*x]},{command:"L",values:[k,.5*x]},{command:"M",values:[.5*k,0]},{command:"L",values:[.5*k,x]}]};break;case"diamond":g.shape={type:"path",path:[{command:"M",values:[0,.5*x]},{command:"L",values:[.5*k,0]},{command:"L",values:[k,.5*x]},{command:"L",values:[.5*k,x]},{command:"Z",values:[]}]},M||(k+=b,x+=b);break;case"square":g.shape={type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[k,0]},{command:"L",values:[k,x]},{command:"L",values:[0,x]},{command:"Z",values:[]}]},M||(k+=b,x+=b),v&&(L=!0);break;case"triangle":g.shape={type:"path",path:[{command:"M",values:[.5*k,0]},{command:"L",values:[k,x]},{command:"L",values:[0,x]},{command:"Z",values:[]}]},M||(k+=b,x+=b),v&&(L=!0);break;case"x":g.shape={type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[k,x]},{command:"M",values:[k,0]},{command:"L",values:[0,x]}]},v&&(L=!0);break;case"path":g.shape={type:"path",path:e.path||""},M||(k+=b,x+=b),v&&(L=!0),M=!0}break}case"simple-line":{const e=Math.min(null!=p?p:b,d||80),a=e>22?2*e:40;w.width=e,k=a,x=e,g.shape={type:"path",path:[{command:"M",values:[0,x]},{command:"L",values:[k,x]}]};break}case u:case"simple-fill":k=Math.min(null!=p?p:22,d||m)+b,x=k,M=!0,g.shape="object"==typeof(null==a?void 0:a.symbolConfig)&&null!=a&&a.symbolConfig.isSquareFill?i.JZ.squareFill[0]:i.JZ.fill[0];break;case"picture-marker":{let a=(0,s.F2)(e.width),t=(0,s.F2)(e.height);const l=null!=p?p:Math.max(a,t),n=a/t;a=n<=1?Math.ceil(l*n):l,t=n<=1?l:Math.ceil(l/n),k=Math.min(a,d||m),x=Math.min(t,d||m),g.shape={type:"image",x:-Math.round(k/2),y:-Math.round(x/2),width:k,height:x,src:e.url||""},v&&(L=!0);break}case"text":{const a=e,t=a.text||"Aa",l=a.font,n=Math.min(null!=p?p:(0,s.F2)(l.size),d||m),o=h(t,{weight:l.weight,size:n,family:l.family}),i=/[\uE600-\uE6FF]/.test(t);k=i?n:o,x=n;let c=.25*function(e){if(0===e.length)return 0;if(e.length>2){const a=(0,s.Wz)(1),t=parseFloat(e);switch(e.slice(-2)){case"px":return t;case"pt":return t*a;case"in":return 72*t*a;case"pc":return 12*t*a;case"mm":return 2.8346456692913384*t*a;case"cm":return 28.346456692913385*t*a}}return parseFloat(e)}((l?n:0).toString());i&&(c+=5),g.shape={type:"text",text:t,x:0,y:c,align:"middle",decoration:l&&l.decoration,rotated:a.rotated,kerning:a.kerning},g.font=l&&{size:n,style:l.style,decoration:l.decoration,weight:l.weight,family:l.family};break}}if(!g.shape)return Promise.reject(new n.Z("symbolPreview: renderPreviewHTML2D","symbol not supported."));const z=y,F=e.color;let C=null;return z&&"pattern"===z.type&&F&&e.type!==u?C=(0,o.Od)(z.src,F.toCss(!0)).then(e=>(z.src=e,g.fill=z,g)):(g.fill=y,C=Promise.resolve(g)),C.then(e=>{const t=[[e]];if("object"==typeof(null==a?void 0:a.symbolConfig)&&null!=a&&a.symbolConfig.applyColorModulation){const a=.6*k;t.unshift([{...e,offset:[-a,0],fill:(0,i.dc)(y,-.3)}]),t.push([{...e,offset:[a,0],fill:(0,i.dc)(y,.3)}]),k+=2*a}return(0,c.w)(t,[k,x],{node:a&&a.node,scale:M,opacity:f,rotation:v,useRotationSize:L})})}}}]);