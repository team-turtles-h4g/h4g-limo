(self.webpackChunkh4g_limo=self.webpackChunkh4g_limo||[]).push([[4233],{24233:(e,t,i)=>{"use strict";i.d(t,{Z:()=>K});var r=i(16304),s=i(2747),n=i(69141),a=i(54704),u=i(1861),o=i(43899),l=i(288),c=i(35718),d=i(2266),h=i(60337),f=i(11909),p=i(73507),y=i(88205),m=i(18612);const g=new class{constructor(e,t){this._cache=new y.Z(e),this._invalidCache=new y.Z(t)}get(e,t){const i=`${t.uid}:${e}`,r=this._cache.get(i);if(r)return r;if(void 0!==this._invalidCache.get(i))return null;try{const r=m.WhereClause.create(e,t);return this._cache.put(i,r),r}catch{return this._invalidCache.put(i,null),null}}}(50,500),x="feature-store:unsupported-query",_=" as ",S=new Set(["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeLong","esriFieldTypeDate"]);function I(e,t){if(!t)return!0;const i=g.get(t,e);if(!i)throw new s.Z(x,"invalid SQL expression",{where:t});if(!i.isStandardized)throw new s.Z(x,"where clause is not standard",{where:t});return R(e,i.fieldNames,"where clause contains missing fields"),!0}function F(e,t,i){if(!t)return!0;const r=g.get(t,e);if(!r)throw new s.Z(x,"invalid SQL expression",{having:t});if(!r.isAggregate)throw new s.Z(x,"having does not contain a valid aggregate function",{having:t});if(R(e,r.fieldNames,"having contains missing fields"),!r.getExpressions().every(t=>{const{aggregateType:r,field:s}=t,n=e.has(s)&&e.get(s).name;return i.some(t=>{const{onStatisticField:i,statisticType:s}=t;return(e.has(i)&&e.get(i).name)===n&&s.toLowerCase().trim()===r})}))throw new s.Z(x,"expressions in having should also exist in outStatistics",{having:t});return!0}function b(e,t){return e?g.get(e,t):null}function R(e,t,i,r=!0){const n=[];for(const a of t)if("*"!==a&&!e.has(a))if(r){const t=v(a);try{const i=b(t,e);if(!i)throw new s.Z(x,"invalid SQL expression",{where:t});if(!i.isStandardized)throw new s.Z(x,"expression is not standard",{clause:i});R(e,i.fieldNames,"expression contains missing fields")}catch(L){const t=L&&L.details;if(t&&(t.clause||t.where))throw L;t&&t.missingFields?n.push(...t.missingFields):n.push(a)}}else n.push(a);if(n.length)throw new s.Z(x,i,{missingFields:n})}function v(e){return e.split(_)[0]}function w(e){return e.split(_)[1]}function A(e,t){const i=t.get(e);return!!i&&!S.has(i.type)}var Q=i(95876),T=i(90495),C=i(10504),P=i(41801),E=i(58466);class N{constructor(e,t,i){this._fieldDataCache=new Map,this._returnDistinctMap=new Map,this.returnDistinctValues=e.returnDistinctValues,this.fieldsIndex=i,this.featureAdapter=t;const r=e.outFields;if(r&&-1===r.indexOf("*")){this.outFields=r;let e=0;for(const t of r){const r=v(t),s=this.fieldsIndex.get(r),n=s?null:b(r,i),a=s?s.name:w(t)||"FIELD_EXP_"+e++;this._fieldDataCache.set(t,{alias:a,clause:n})}}}countDistinctValues(e){return this.returnDistinctValues?(e.forEach(e=>this.getAttributes(e)),this._returnDistinctMap.size):e.length}getAttributes(e){const t=this._processAttributesForOutFields(e);return this._processAttributesForDistinctValues(t)}getFieldValue(e,t,i){const r=i?i.name:t;let s=null;return this._fieldDataCache.has(r)?s=this._fieldDataCache.get(r).clause:i||(s=b(t,this.fieldsIndex),this._fieldDataCache.set(r,{alias:r,clause:s})),i?this.featureAdapter.getAttribute(e,r):s.calculateValue(e,this.featureAdapter)}getNormalizedValue(e,t){const i=t.normalizationType,r=t.normalizationTotal;let s=this.getFieldValue(e,t.field,t.fieldInfo);if(i&&Number.isFinite(s)){const n=this.getFieldValue(e,t.normalizationField,t.normalizationFieldInfo);s=(0,E.fk)(s,i,n,r)}return s}getExpressionValue(e,t,i){const r={attributes:this.featureAdapter.getAttributes(e)},s=i.createExecContext(r,t.viewInfo);return i.executeFunction(t.compiledFunc,s)}validateItem(e,t){return this._fieldDataCache.has(t)||this._fieldDataCache.set(t,{alias:t,clause:b(t,this.fieldsIndex)}),this._fieldDataCache.get(t).clause.testFeature(e,this.featureAdapter)}validateItems(e,t){return this._fieldDataCache.has(t)||this._fieldDataCache.set(t,{alias:t,clause:b(t,this.fieldsIndex)}),this._fieldDataCache.get(t).clause.testSet(e,this.featureAdapter)}_processAttributesForOutFields(e){const t=this.outFields;if(!t||!t.length)return this.featureAdapter.getAttributes(e);const i={};for(const r of t){const{alias:t,clause:s}=this._fieldDataCache.get(r);i[t]=s?s.calculateValue(e,this.featureAdapter):this.featureAdapter.getAttribute(e,t)}return i}_processAttributesForDistinctValues(e){if((0,a.Wi)(e)||!this.returnDistinctValues)return e;const t=this.outFields,i=[];if(t)for(const n of t){const{alias:t}=this._fieldDataCache.get(n);i.push(e[t])}else for(const n in e)i.push(e[n]);const r=`${(t||["*"]).join(",")}=${i.join(",")}`;let s=this._returnDistinctMap.get(r)||0;return this._returnDistinctMap.set(r,++s),s>1?null:e}}var Z=i(32931),V=i(77270),M=i(21550),G=i(10954);function z(e){return e.substr(24,12)+e.substr(19,4)+e.substr(16,2)+e.substr(14,2)+e.substr(11,2)+e.substr(9,2)+e.substr(6,2)+e.substr(4,2)+e.substr(2,2)+e.substr(0,2)}function O(e,t,i){return(i?e>t:e<t)?-1:(i?e<t:e>t)?1:0}function D(e,t,i){return i?t-e:e-t}function k(e,t,i,r){if(i&&"esriFieldTypeDate"===i.type){const i=new Date(e).getTime(),s=new Date(t).getTime();if(!isNaN(i)&&!isNaN(s))return D(i,s,r)}if("number"==typeof e&&"number"==typeof t)return D(e,t,r);if("string"==typeof e&&"string"==typeof t){const s=e.toUpperCase(),n=t.toUpperCase();return!i||"esriFieldTypeGUID"!==i.type&&"esriFieldTypeGlobalID"!==i.type?O(s,n,r):O(z(s),z(n),r)}return r?1:-1}class j{constructor(e,t,i){this.items=e,this.queryGeometry=t,this.definitionExpression=i.definitionExpression,this.geometryType=i.geometryType,this.hasM=i.hasM,this.hasZ=i.hasZ,this.objectIdField=i.objectIdField,this.spatialReference=i.spatialReference,this.fieldsIndex=i.fieldsIndex,this.timeInfo=i.timeInfo,this.featureAdapter=i.featureAdapter,this.aggregateAdapter=i.aggregateAdapter}get size(){return this.items.length}createQueryResponseForCount(e){const t=new N(e,this.featureAdapter,this.fieldsIndex);if(!e.outStatistics)return t.countDistinctValues(this.items);const{groupByFieldsForStatistics:i,having:r}=e;if(!(null==i?void 0:i.length))return 1;const s=new Map,n=new Map,a=new Set,u=e.outStatistics;for(const o of u){const{statisticType:e}=o,u="exceedslimit"!==e?o.onStatisticField:void 0;if(!n.has(u)){const e=[];for(const r of i){const i=this._getAttributeValues(t,r,s);e.push(i)}n.set(u,this._calculateUniqueValues(e,t.returnDistinctValues))}const l=n.get(u);for(const i in l){const{data:e,items:s}=l[i],n=e.join(",");r&&!t.validateItems(s,r)||a.add(n)}}return a.size}createQueryResponse(e){let t;return t=e.outStatistics?e.outStatistics.some(e=>"exceedslimit"===e.statisticType)?this._createExceedsLimitQueryResponse(e):this._createStatisticsQueryResponse(e):this._createFeatureQueryResponse(e),e.returnQueryGeometry&&(t.queryGeometry=(0,p.JY)(e.outSR)&&!(0,p.fS)(this.queryGeometry.spatialReference,e.outSR)?(0,V.S2)({spatialReference:e.outSR,...(0,Q.iV)(this.queryGeometry,this.queryGeometry.spatialReference,e.outSR)}):(0,V.S2)({spatialReference:e.outSR,...this.queryGeometry})),t}createSnappingResponse(e,t){const i=this.featureAdapter,r=function(e,t){return e?t?4:3:t?3:2}(this.hasZ,this.hasM),{x:s,y:n}=e.point,u="number"==typeof e.distance?e.distance:e.distance.x,o="number"==typeof e.distance?e.distance:e.distance.y,l={candidates:[]},c="esriGeometryPolygon"===this.geometryType,d=this.getPointCreator(e.point,this.spatialReference,t);for(const h of this.items){const t=i.getGeometry(h);if((0,a.Wi)(t))continue;const{coords:f,lengths:p}=t;if(1&e.types){let e=0;for(let t=0;t<p.length;t++){const a=p[t];for(let t=0;t<a;t++,e+=r){const c=f[e],p=f[e+1];if(t!==a-1){const t=f[e+r],a=f[e+r+1],{x:y,y:m}=q(s,n,c,p,t,a),g=(s-y)/u,x=(n-m)/o,_=g*g+x*x;_<=1&&l.candidates.push({type:"edge",objectId:i.getObjectId(h),distance:Math.sqrt(_),target:d(y,m),start:d(c,p),end:d(t,a)})}}}}if(2&e.types){const e=c?f.length-r:f.length;for(let t=0;t<e;t+=r){const e=f[t],r=f[t+1],a=(s-e)/u,c=(n-r)/o,p=a*a+c*c;p<=1&&l.candidates.push({type:"vertex",objectId:i.getObjectId(h),distance:Math.sqrt(p),target:d(e,r)})}}}return l.candidates.sort((e,t)=>e.distance-t.distance),l}getPointCreator(e,t,i){const r=(0,a.pC)(i)&&!(0,p.fS)(t,i)?e=>(0,Q.iV)(e,t,i):e=>e;return null!=e.z&&null!=e.m?(t,i)=>r({x:t,y:i,z:e.z,m:e.m}):null!=e.z?(t,i)=>r({x:t,y:i,z:e.z}):null!=e.m?(t,i)=>r({x:t,y:i,m:e.m}):(e,t)=>r({x:e,y:t})}executeAttributesQuery(e){const t=b(e.where,this.fieldsIndex);if(!t)return Promise.resolve(this);if(t.isStandardized){let i=0;const r=[];for(const e of this.items)t.testFeature(e,this.featureAdapter)&&(r[i++]=e);const s=new j(r,this.queryGeometry,this);return s.definitionExpression=e.where,Promise.resolve(s)}return Promise.reject(new TypeError("Where clause is not standardized"))}executeAggregateIdsQuery(e){if(!e.aggregateIds||!e.aggregateIds.length||(0,a.Wi)(this.aggregateAdapter))return Promise.resolve(this);const t=new Set;for(const r of e.aggregateIds)this.aggregateAdapter.getFeatureObjectIds(r).forEach(e=>t.add(e));const i=this.featureAdapter.getObjectId;return Promise.resolve(new j(this.items.filter(e=>t.has(i(e))),this.queryGeometry,this))}executeObjectIdsQuery(e){if(!e.objectIds||!e.objectIds.length)return Promise.resolve(this);const t=new Set(e.objectIds),i=this.featureAdapter.getObjectId;return Promise.resolve(new j(this.items.filter(e=>t.has(i(e))),this.queryGeometry,this))}executeTimeQuery(e){const t=(0,Z.y)(this.timeInfo,e.timeExtent,this.featureAdapter);if(!(0,a.pC)(t))return Promise.resolve(this);const i=this.items.filter(t);return Promise.resolve(new j(i,this.queryGeometry,this))}filterLatest(){const{trackIdField:e,startTimeField:t,endTimeField:i}=this.timeInfo,r=i||t,s=new Map,n=this.featureAdapter.getAttribute;for(const u of this.items){const t=n(u,e),i=n(u,r),a=s.get(t);(!a||i>n(a,r))&&s.set(t,u)}const a=Array.from(s.values());return Promise.resolve(new j(a,this.queryGeometry,this))}project(e){var t=this;return(0,r.Z)(function*(){if(!e||(0,p.fS)(t.spatialReference,e))return t;const i=t.featureAdapter,r=(yield(0,Q.oj)(t.items.map(e=>(0,V.Op)(t.geometryType,t.hasZ,t.hasM,i.getGeometry(e))),t.spatialReference,e)).map((e,r)=>i.cloneWithGeometry(t.items[r],(0,P.GH)(e,t.hasZ,t.hasM)));return new j(r,t.queryGeometry,{definitionExpression:t.definitionExpression,geometryType:t.geometryType,hasM:t.hasM,hasZ:t.hasZ,objectIdField:t.objectIdField,spatialReference:e,fieldsIndex:t.fieldsIndex,timeInfo:t.timeInfo,featureAdapter:t.featureAdapter})})()}createSummaryStatisticsResponse(e,t){var i=this;return(0,r.Z)(function*(){const{field:r,normalizationField:s,normalizationType:n,normalizationTotal:a,minValue:u,maxValue:o}=t,l=new N(e,i.featureAdapter,i.fieldsIndex),c=i.fieldsIndex.isDateField(r),d=t.valueExpression?yield i._getAttributeExpressionValues(l,t.valueExpression,t.viewInfoParams):i._getAttributeNormalizedValues(l,{field:r,normalizationField:s,normalizationType:n,normalizationTotal:a}),h=(0,E.S5)({normalizationType:n,normalizationField:s,minValue:u,maxValue:o}),f=(0,M.qN)(i.fieldsIndex.get(r))?(0,E.H0)({values:d,supportsNullCount:h}):(0,E.i5)({values:d,minValue:u,maxValue:o,useSampleStdDev:!n,supportsNullCount:h});return(0,E.rt)(f,c)})()}_sortFeatures(e,t,i){if(e.length>1&&t&&t.length)for(const r of t.reverse()){const t=r.split(" "),s=t[0],n=this.fieldsIndex.get(s),a=t[1]&&"desc"===t[1].toLowerCase();e.sort((e,t)=>k(i(e,s,n),i(t,s,n),n,a))}}_createFeatureQueryResponse(e){const t=this.items,{geometryType:i,hasM:r,hasZ:s,objectIdField:n,spatialReference:a}=this,{outFields:u,outSR:o,quantizationParameters:l,resultRecordCount:c,resultOffset:d,returnZ:h,returnM:f}=e,p=null!=c&&t.length>(d||0)+c,y=u&&(u.indexOf("*")>-1?[...this.fieldsIndex.fields]:u.map(e=>this.fieldsIndex.get(e)));return{exceededTransferLimit:p,features:this._createFeatures(e,t),fields:y,geometryType:i,hasM:r&&f,hasZ:s&&h,objectIdFieldName:n,spatialReference:(0,V.S2)(o||a),transform:l&&(0,C.vY)(l)||null}}_createFeatures(e,t){const i=new N(e,this.featureAdapter,this.fieldsIndex),{hasM:r,hasZ:s}=this,{orderByFields:n,quantizationParameters:a,returnGeometry:u,returnCentroid:o,maxAllowableOffset:l,resultOffset:c,resultRecordCount:d,returnZ:h=!1,returnM:f=!1}=e,p=s&&h,y=r&&f;let m=[],g=0;const x=[...t];if(this._sortFeatures(x,n,(e,t,r)=>i.getFieldValue(e,t,r)),u||o){const e=(0,C.vY)(a);if(u&&!o)for(const t of x)m[g++]={attributes:i.getAttributes(t),geometry:(0,V.Op)(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(t),l,e,p,y)};else if(!u&&o)for(const t of x)m[g++]={attributes:i.getAttributes(t),centroid:(0,V.EG)(this,this.featureAdapter.getCentroid(t,this),e)};else for(const t of x)m[g++]={attributes:i.getAttributes(t),centroid:(0,V.EG)(this,this.featureAdapter.getCentroid(t,this),e),geometry:(0,V.Op)(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(t),l,e,p,y)}}else for(const S of x){const e=i.getAttributes(S);e&&(m[g++]={attributes:e})}const _=c||0;return null!=d&&(m=m.slice(_,Math.min(m.length,_+d))),m}_createExceedsLimitQueryResponse(e){let t=!1,i=Number.POSITIVE_INFINITY,r=Number.POSITIVE_INFINITY,s=Number.POSITIVE_INFINITY;for(const n of e.outStatistics)if("exceedslimit"===n.statisticType){i=null!=n.maxPointCount?n.maxPointCount:Number.POSITIVE_INFINITY,r=null!=n.maxRecordCount?n.maxRecordCount:Number.POSITIVE_INFINITY,s=null!=n.maxVertexCount?n.maxVertexCount:Number.POSITIVE_INFINITY;break}if("esriGeometryPoint"===this.geometryType)t=this.items.length>i;else if(this.items.length>r)t=!0;else{const e=this.hasZ?this.hasM?4:3:this.hasM?3:2,i=this.featureAdapter;t=this.items.reduce((e,t)=>{const r=i.getGeometry(t);return e+((0,a.pC)(r)&&r.coords.length||0)},0)/e>s}return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(t)}}]}}_createStatisticsQueryResponse(e){const t={attributes:{}},i=[],r=new Map,s=new Map,n=new Map,a=new Map,u=new N(e,this.featureAdapter,this.fieldsIndex),o=e.outStatistics,{groupByFieldsForStatistics:l,having:c,orderByFields:d}=e,h=l&&l.length,f=!!h,p=f&&l[0],y=f&&!this.fieldsIndex.get(p);for(const g of o){const{outStatisticFieldName:e,statisticType:o}=g,d=g,m="exceedslimit"!==o?g.onStatisticField:void 0,x="percentile_disc"===o||"percentile_cont"===o,_=f&&1===h&&(m===p||y)&&"count"===o;if(f){if(!n.has(m)){const e=[];for(const t of l){const i=this._getAttributeValues(u,t,r);e.push(i)}n.set(m,this._calculateUniqueValues(e,u.returnDistinctValues))}const t=n.get(m);for(const i in t){const{count:s,data:n,items:o,itemPositions:h}=t[i],f=n.join(",");if(!c||u.validateItems(o,c)){const t=a.get(f)||{attributes:{}};let i=null;if(_)i=s;else{const e=this._getAttributeValues(u,m,r),t=h.map(t=>e[t]);i=x&&"statisticParameters"in d?this._getPercentileValue(d,t):this._getStatisticValue(d,t,null,u.returnDistinctValues)}t.attributes[e]=i,l.forEach((e,i)=>t.attributes[this.fieldsIndex.get(e)?e:`EXPR_${i+1}`]=n[i]),a.set(f,t)}}}else{const i=this._getAttributeValues(u,m,r);t.attributes[e]=x&&"statisticParameters"in d?this._getPercentileValue(d,i):this._getStatisticValue(d,i,s,u.returnDistinctValues)}i.push({name:e,alias:e,type:"esriFieldTypeDouble"})}const m=f?Array.from(a.values()):[t];return this._sortFeatures(m,d,(e,t)=>e.attributes[t]),{fields:i,features:m}}_getStatisticValue(e,t,i,r){const{onStatisticField:s,statisticType:n}=e;let a=null;return a=null!=i&&i.has(s)?i.get(s):(0,M.qN)(this.fieldsIndex.get(s))?(0,E.H0)({values:t,returnDistinct:r}):(0,E.i5)({values:t,minValue:null,maxValue:null,useSampleStdDev:!0}),i&&i.set(s,a),a["var"===n?"variance":n]}_getPercentileValue(e,t){const{onStatisticField:i,statisticParameters:r,statisticType:s}=e,{value:n,orderBy:a}=r,u="desc"===a,o=this.fieldsIndex.get(i),l=[...t].filter(e=>null!=e).sort((e,t)=>k(e,t,o,u));return this._calculatePercentile(l,n,"percentile_disc"===s)}_getAttributeValues(e,t,i){if(i.has(t))return i.get(t);const r=this.fieldsIndex.get(t),s=this.items.map(i=>e.getFieldValue(i,t,r));return i.set(t,s),s}_getAttributeNormalizedValues(e,t){return this.items.map(i=>e.getNormalizedValue(i,{field:t.field,fieldInfo:this.fieldsIndex.get(t.field),normalizationField:t.normalizationField,normalizationFieldInfo:this.fieldsIndex.get(t.normalizationField),normalizationType:t.normalizationType,normalizationTotal:t.normalizationTotal}))}_getAttributeExpressionValues(e,t,i){var s=this;return(0,r.Z)(function*(){const{arcadeUtils:r}=yield(0,G.LC)(),n=r.createFunction(t),a=i&&r.getViewInfo(i);return s.items.map(t=>e.getExpressionValue(t,{compiledFunc:n,viewInfo:a},r))})()}_calculateUniqueValues(e,t){const i={},r=this.items,s=r.length;for(let n=0;n<s;n++){const s=r[n],a=[];for(const t of e)a.push(t[n]);const u=a.join(",");t?null==i[u]&&(i[u]={count:1,data:a,items:[s],itemPositions:[n]}):null==i[u]?i[u]={count:1,data:a,items:[s],itemPositions:[n]}:(i[u].count++,i[u].items.push(s),i[u].itemPositions.push(n))}return i}_calculatePercentile(e,t,i){if(0===e.length)return null;if(t<=0)return e[0];if(t>=1)return e[e.length-1];const r=(e.length-1)*t,s=Math.floor(r),n=s+1,a=r%1,u=e[s],o=e[n];return n>=e.length||i||"string"==typeof u||"string"==typeof o?u:u*(1-a)+o*a}}function q(e,t,i,r,s,n){const a=s-i,u=n-r,o=Math.min(1,Math.max(0,((e-i)*a+(t-r)*u)/(a*a+u*u)));return{x:i+a*o,y:r+u*o}}var U=i(55278),B=i(37405),W=i(98154);class Y{constructor(){this._tasks=new Array}get length(){return this._tasks.length}push(e,t,i){return new Promise((r,s)=>this._tasks.push(new L(r,s,e,t,i)))}unshift(e,t,i){return new Promise((r,s)=>this._tasks.unshift(new L(r,s,e,t,i)))}process(){if(0===this._tasks.length)return!1;const e=this._tasks.shift();try{const t=(0,W.Hc)(e.signal);if(t&&!e.abortCallback)e.reject((0,W.zE)());else{const i=t?e.abortCallback((0,W.zE)()):e.callback();(0,W.tI)(i)?i.then(e.resolve,e.reject):e.resolve(i)}}catch(L){e.reject(L)}return!0}cancelAll(){const e=(0,W.zE)();for(const t of this._tasks)if(t.abortCallback){const i=t.abortCallback(e);t.resolve(i)}else t.reject(e);this._tasks.length=0}}class L{constructor(e,t,i,r,s){this.resolve=e,this.reject=t,this.callback=i,this.signal=r,this.abortCallback=s}}const J="feature-store:unsupported-query",H=new Set,X=new u.WJ(2e6);let $=0;class K{constructor(e){this.capabilities={query:T.g},this.geometryType=e.geometryType,this.hasM=e.hasM,this.hasZ=e.hasZ,this.objectIdField=e.objectIdField,this.spatialReference=e.spatialReference,this.definitionExpression=e.definitionExpression,this.featureStore=e.featureStore,this.aggregateAdapter=e.aggregateAdapter,this._changeHandle=this.featureStore.events.on("changed",()=>this.clearCache()),this.timeInfo=e.timeInfo,e.cacheSpatialQueries&&(this._geometryQueryCache=new u.Xq($+++"$$",X)),this.fieldsIndex=new B.Z(e.fields),e.scheduler&&e.priority&&(this._frameQueue=new Y,this._frameTask=e.scheduler.registerTask(e.priority,this))}destroy(){this._frameTask&&(this._frameTask.remove(),this._frameTask=null,this._frameQueue.cancelAll(),this._frameQueue=null),this.clearCache(),this._geometryQueryCache&&this._geometryQueryCache.destroy(),this._changeHandle&&(this._changeHandle.remove(),this._changeHandle=null),this.fieldsIndex.destroy()}get featureAdapter(){return this.featureStore.featureAdapter}get fullExtent(){const e=this.featureStore.fullBounds;return e?{xmin:e[0],ymin:e[1],xmax:e[2],ymax:e[3],spatialReference:(0,V.S2)(this.spatialReference)}:null}get timeExtent(){return this.timeInfo?(this._timeExtent||(this._timeExtent=(0,Z.R)(this.timeInfo,this.featureStore)),this._timeExtent):null}clearCache(){this._geometryQueryCache&&this._geometryQueryCache.clear(),this._allItems=null,this._timeExtent=null}executeQuery(e={},t){var i=this;return(0,r.Z)(function*(){let r,s=(0,n.d9)(e);try{s=yield i._schedule(()=>(0,V.Up)(s,i.definitionExpression,i.spatialReference),t),s=yield i._reschedule(()=>i._checkQuerySupport(s),t),r=yield i._reschedule(()=>i._executeGeometryQuery(s,t),t),r=yield i._reschedule(()=>r.executeAggregateIdsQuery(s),t),r=yield i._reschedule(()=>r.executeObjectIdsQuery(s),t),r=yield i._reschedule(()=>r.executeTimeQuery(s),t),r=yield i._reschedule(()=>r.executeAttributesQuery(s),t)}catch(L){if(L!==V.vF)throw L;r=new j([],null,i)}return r.createQueryResponse(s)})()}executeQueryForCount(e={},t){var i=this;return(0,r.Z)(function*(){let r,s=(0,n.d9)(e);s.returnGeometry=!1,s.returnCentroid=!1,s.outSR=null;try{s=yield i._schedule(()=>(0,V.Up)(s,i.definitionExpression,i.spatialReference),t),s=yield i._reschedule(()=>i._checkQuerySupport(s),t),r=yield i._reschedule(()=>i._executeGeometryQuery(s,t),t),r=yield i._reschedule(()=>r.executeAggregateIdsQuery(s),t),r=yield i._reschedule(()=>r.executeObjectIdsQuery(s),t),r=yield i._reschedule(()=>r.executeTimeQuery(s),t),r=yield i._reschedule(()=>r.executeAttributesQuery(s),t)}catch(L){if(L!==V.vF)throw L;return 0}return r.createQueryResponseForCount(s)})()}executeQueryForExtent(e={},t){var i=this;return(0,r.Z)(function*(){let r,s=(0,n.d9)(e);const a=s.outSR;try{s=yield i._schedule(()=>(0,V.Up)(s,i.definitionExpression,i.spatialReference),t),s=yield i._reschedule(()=>i._checkQuerySupport(s),t),s.returnGeometry=!0,s.returnCentroid=!1,s.outSR=null,r=yield i._reschedule(()=>i._executeGeometryQuery(s,t),t),r=yield i._reschedule(()=>r.executeAggregateIdsQuery(s),t),r=yield i._reschedule(()=>r.executeObjectIdsQuery(s),t),r=yield i._reschedule(()=>r.executeTimeQuery(s),t),r=yield i._reschedule(()=>r.executeAttributesQuery(s),t);const e=r.size;if(!e)return{count:e,extent:null};(0,l.t8)(te,l.Gv),i.featureStore.forEachBounds(r.items,e=>(0,l.TC)(te,e),ee);const n={xmin:te[0],ymin:te[1],xmax:te[3],ymax:te[4],spatialReference:(0,V.S2)(i.spatialReference)};i.hasZ&&isFinite(te[2])&&isFinite(te[5])&&(n.zmin=te[2],n.zmax=te[5]);const u=(0,Q.iV)(n,r.spatialReference,a);if(u.spatialReference=(0,V.S2)(a||i.spatialReference),u.xmax-u.xmin==0){const e=(0,o.c9)(u.spatialReference);u.xmin-=e,u.xmax+=e}if(u.ymax-u.ymin==0){const e=(0,o.c9)(u.spatialReference);u.ymin-=e,u.ymax+=e}if(i.hasZ&&null!=u.zmin&&null!=u.zmax&&u.zmax-u.zmin==0){const e=(0,o.c9)(u.spatialReference);u.zmin-=e,u.zmax+=e}return{count:e,extent:u}}catch(u){if(u===V.vF)return{count:0,extent:null};throw u}})()}executeQueryForIds(e={},t){var i=this;return(0,r.Z)(function*(){return i.executeQueryForIdSet(e,t).then(e=>Array.from(e))})()}executeQueryForIdSet(e={},t){var i=this;return(0,r.Z)(function*(){let r,s=(0,n.d9)(e);s.returnGeometry=!1,s.returnCentroid=!1,s.outSR=null;try{s=yield i._schedule(()=>(0,V.Up)(s,i.definitionExpression,i.spatialReference),t),s=yield i._reschedule(()=>i._checkQuerySupport(s),t),r=yield i._reschedule(()=>i._executeGeometryQuery(s,t),t),r=yield i._reschedule(()=>r.executeAggregateIdsQuery(s),t),r=yield i._reschedule(()=>r.executeObjectIdsQuery(s),t),r=yield i._reschedule(()=>r.executeTimeQuery(s),t),r=yield i._reschedule(()=>r.executeAttributesQuery(s),t);const e=r.items,n=new Set;return yield i._reschedule(()=>{for(const t of e)n.add(r.featureAdapter.getObjectId(t))},t),n}catch(L){if(L===V.vF)return new Set;throw L}})()}executeQueryForSnapping(e,t){var i=this;return(0,r.Z)(function*(){const{point:r,distance:s,types:n}=e;if(0===n)return{candidates:[]};const u=yield i._reschedule(()=>i._checkQuerySupport(e.query),t),o=!(0,p.fS)(r.spatialReference,i.spatialReference);o&&(yield(0,Q._W)(r.spatialReference,i.spatialReference));const l="number"==typeof s?s:s.x,c="number"==typeof s?s:s.y,d={xmin:r.x-l,xmax:r.x+l,ymin:r.y-c,ymax:r.y+c,spatialReference:r.spatialReference},y=o?(0,Q.iV)(d,i.spatialReference):d;if(!y)return{candidates:[]};const m=(yield(0,f.aX)((0,h.im)(r),null,{signal:t}))[0],g=(yield(0,f.aX)((0,h.im)(y),null,{signal:t}))[0];if((0,a.Wi)(m)||(0,a.Wi)(g))return{candidates:[]};let x=new j(i._searchFeatures(i._getQueryBBoxes(g.toJSON())),null,i);x=yield i._reschedule(()=>x.executeObjectIdsQuery(u),t),x=yield i._reschedule(()=>x.executeTimeQuery(u),t),x=yield i._reschedule(()=>x.executeAttributesQuery(u),t);const _=m.toJSON(),S=o?(0,Q.iV)(_,i.spatialReference):_,I=o?Math.max(y.xmax-y.xmin,y.ymax-y.ymin)/2:s;return x.createSnappingResponse({...e,point:S,distance:I},r.spatialReference)})()}executeQueryForLatestObservations(e={},t){var i=this;return(0,r.Z)(function*(){if(!i.timeInfo||!i.timeInfo.trackIdField)throw new s.Z(J,"Missing timeInfo or timeInfo.trackIdField",{query:e,timeInfo:i.timeInfo});let r,a=(0,n.d9)(e);try{a=yield i._schedule(()=>(0,V.Up)(a,i.definitionExpression,i.spatialReference),t),a=yield i._reschedule(()=>i._checkQuerySupport(a),t),r=yield i._reschedule(()=>i._executeGeometryQuery(a,t),t),r=yield i._reschedule(()=>r.executeAggregateIdsQuery(a),t),r=yield i._reschedule(()=>r.executeObjectIdsQuery(a),t),r=yield i._reschedule(()=>r.executeTimeQuery(a),t),r=yield i._reschedule(()=>r.executeAttributesQuery(a),t),r=yield i._reschedule(()=>r.filterLatest(),t)}catch(x){if(x!==V.vF)throw x;r=new j([],null,i)}return r.createQueryResponse(a)})()}executeQueryForSummaryStatistics(e={},t,i){var s=this;return(0,r.Z)(function*(){let r;e=(0,n.d9)(e);try{e=yield s._schedule(()=>(0,V.Up)(e,s.definitionExpression,s.spatialReference),i),e=yield s._reschedule(()=>s._checkSummaryStatisticsSupport(e,t),i),r=yield s._reschedule(()=>s._executeGeometryQuery(e,i),i),r=yield s._reschedule(()=>r.executeAggregateIdsQuery(e),i),r=yield s._reschedule(()=>r.executeObjectIdsQuery(e),i),r=yield s._reschedule(()=>r.executeTimeQuery(e),i),r=yield s._reschedule(()=>r.executeAttributesQuery(e),i)}catch(L){if(L!==V.vF)throw L;r=new j([],null,s)}return r.createSummaryStatisticsResponse(e,t)})()}_schedule(e,t){var i=this;return(0,r.Z)(function*(){return i._frameQueue?i._frameQueue.push(e,t):e()})()}_reschedule(e,t){var i=this;return(0,r.Z)(function*(){return i._frameQueue?i._frameQueue.unshift(e,t):e()})()}get running(){return this._frameQueue.length>0}runTask(e){for(this._budget=e;!e.done&&this._frameQueue&&this._frameQueue.process();)e.madeProgress();this._budget=null}_getAll(){if(!this._allItems){const e=[];this.featureStore.forEach(t=>e.push(t)),this._allItems=new j(e,null,this)}return this._allItems}_executeGeometryQuery(e,t){var i=this;return(0,r.Z)(function*(){const{geometry:s,outSR:n,spatialRel:u,returnGeometry:o,returnCentroid:l}=e,c=o||l,d=(0,p.JY)(n)&&!(0,p.fS)(i.spatialReference,n),h=i._geometryQueryCache?d&&c?JSON.stringify({geometry:s,spatialRelationship:u,outSpatialReference:n}):JSON.stringify({geometry:s,spatialRelationship:u}):null;if(h){const e=i._geometryQueryCache.get(h);if(!(0,a.o8)(e))return e}const f=function(){var e=(0,r.Z)(function*(e){if(d&&c){const t=yield e.project(n);return h&&i._geometryQueryCache.put(h,t,t.size||1),t}return h&&i._geometryQueryCache.put(h,e,e.size||1),e});return function(t){return e.apply(this,arguments)}}();if(!s)return f(i._getAll());const y=i.featureAdapter;if("esriSpatialRelDisjoint"===u){const e=i._searchFeatures(i._getQueryBBoxes(s));if(!e.length)return f(i._getAll());let n,a;const o=new Set;for(const t of e)o.add(y.getObjectId(t));return yield i._reschedule(()=>{let e=0;n=new Array(o.size),i.featureStore.forEach(t=>n[e++]=t),a=o},t),f(yield i._reschedule((0,r.Z)(function*(){const e=yield(0,U.cW)(u,s,i.geometryType,i.hasZ,i.hasM);return new j(yield i._runSpatialFilter(n,t=>!a.has(y.getObjectId(t))||e(y.getGeometry(t)),t),s,i)}),t))}const m=i._searchFeatures(i._getQueryBBoxes(s));if(!m.length){const e=new j([],s,i);return h&&i._geometryQueryCache.put(h,e,e.size||1),e}if(i._canExecuteSoloPass(s,e))return f(new j(m,s,i));const g=yield(0,U.cW)(u,s,i.geometryType,i.hasZ,i.hasM),x=yield i._runSpatialFilter(m,e=>g(y.getGeometry(e)),t);return f(new j(x,s,i))})()}_runSpatialFilter(e,t,i){var s=this;return(0,r.Z)(function*(){if(!t)return e;if(!s._budget)return e.filter(e=>t(e));let n=0;const a=new Array,u=function(){var o=(0,r.Z)(function*(){for(;n<e.length;){const r=e[n];t(r)&&a.push(r),s._budget.done&&(yield s._reschedule(()=>u(),i)),++n}});return function(){return o.apply(this,arguments)}}();return s._reschedule(()=>u(),i).then(()=>a)})()}_canExecuteSoloPass(e,t){const{geometryType:i}=this,{spatialRel:r}=t;return(0,U.hN)(e)&&("esriSpatialRelEnvelopeIntersects"===r||"esriGeometryPoint"===i&&("esriSpatialRelIntersects"===r||"esriSpatialRelContains"===r||"esriSpatialRelWithin"===r))}_getQueryBBoxes(e){if((0,U.hN)(e)){if((0,h.YX)(e))return[(0,c.al)(e.xmin,e.ymin,e.xmax,e.ymax)];if((0,h.oU)(e))return e.rings.map(e=>(0,c.al)(Math.min(e[0][0],e[2][0]),Math.min(e[0][1],e[2][1]),Math.max(e[0][0],e[2][0]),Math.max(e[0][1],e[2][1])))}return[(0,d.$P)((0,c.Ue)(),e)]}_searchFeatures(e){for(const r of e)this.featureStore.forEachInBounds(r,e=>{H.add(e)});const t=new Array(H.size);let i=0;return H.forEach(e=>t[i++]=e),H.clear(),t}_checkSummaryStatisticsSupport(e,t){var i=this;return(0,r.Z)(function*(){if(e.distance<0||null!=e.geometryPrecision||e.multipatchOption||e.pixelSize||e.relationParam||e.text||e.outStatistics||e.groupByFieldsForStatistics||e.having||e.orderByFields)throw new s.Z(J,"Unsupported query options",{query:e});return Promise.all([i._checkAttributesQuerySupport(e),i._checkSummaryStatisticsParamsSupport(t),(0,U.P0)(e,i.geometryType,i.spatialReference),(0,Q._W)(i.spatialReference,e.outSR)]).then(()=>e)})()}_checkSummaryStatisticsParamsSupport(e){var t=this;return(0,r.Z)(function*(){let i=[];if(e.valueExpression){const{arcadeUtils:t}=yield(0,G.LC)();i=t.extractFieldNames(e.valueExpression)}if(e.field&&i.push(e.field),e.normalizationField&&i.push(e.normalizationField),!i.length)throw new s.Z(J,"params should have at least a field or valueExpression",{params:e});R(t.fieldsIndex,i,"params contains missing fields")})()}_checkQuerySupport(e){var t=this;return(0,r.Z)(function*(){if(e.distance<0||null!=e.geometryPrecision||e.multipatchOption||e.pixelSize||e.relationParam||e.text)throw new s.Z(J,"Unsupported query options",{query:e});return Promise.all([t._checkAttributesQuerySupport(e),t._checkStatisticsQuerySupport(e),(0,U.P0)(e,t.geometryType,t.spatialReference),(0,Q._W)(t.spatialReference,e.outSR)]).then(()=>e)})()}_checkAttributesQuerySupport(e){const{outFields:t,orderByFields:i,returnDistinctValues:r,outStatistics:n}=e,a=n?n.map(e=>e.outStatisticFieldName&&e.outStatisticFieldName.toLowerCase()):[];if(i&&i.length>0){const e=" asc",t=" desc",r=i.map(i=>{const r=i.toLowerCase();return r.indexOf(e)>-1?r.split(e)[0]:r.indexOf(t)>-1?r.split(t)[0]:i}).filter(e=>-1===a.indexOf(e));R(this.fieldsIndex,r,"orderByFields contains missing fields")}if(t&&t.length>0)R(this.fieldsIndex,t,"outFields contains missing fields");else if(r)throw new s.Z(J,"outFields should be specified for returnDistinctValues",{query:e});I(this.fieldsIndex,e.where)}_checkStatisticsQuerySupport(e){var t=this;return(0,r.Z)(function*(){const{outStatistics:i,groupByFieldsForStatistics:r,having:n}=e,a=r&&r.length,u=i&&i.length;if(n){if(!a||!u)throw new s.Z(J,"outStatistics and groupByFieldsForStatistics should be specified with having",{query:e});F(t.fieldsIndex,n,i)}if(u){if(!i.every(e=>"exceedslimit"!==e.statisticType))return;const n=i.map(e=>e.onStatisticField);R(t.fieldsIndex,n,"onStatisticFields contains missing fields"),a&&R(t.fieldsIndex,r,"groupByFieldsForStatistics contains missing fields");for(const r of i){const{onStatisticField:i,statisticType:n}=r;if("percentile_disc"!==n&&"percentile_cont"!==n||!("statisticParameters"in r)){if("count"!==n&&i&&A(i,t.fieldsIndex))throw new s.Z(J,"outStatistics contains non-numeric fields",{definition:r,query:e})}else{const{statisticParameters:t}=r;if(!t)throw new s.Z(J,"statisticParamters should be set for percentile type",{definition:r,query:e})}}}})()}}const ee=(0,l.Ue)(),te=(0,l.Ue)()},90495:(e,t,i)=>{"use strict";i.d(t,{g:()=>r});const r={supportsStatistics:!0,supportsPercentileStatistics:!0,supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsTopFeaturesQuery:!1,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0}},55278:(e,t,i)=>{"use strict";i.d(t,{hN:()=>Q,P0:()=>w,cW:()=>v});var r=i(16304),s=i(2747),n=i(61182),a=i(23469),u=i(60337),o=i(73507);function l(e,t){return e?t?4:3:t?3:2}function c(e,t,i,r,s,n){const a=l(s,n),{coords:u,lengths:o}=r;if(!o)return!1;for(let l=0,c=0;l<o.length;l++,c+=a)if(!d(e,t,i,u[c],u[c+1]))return!1;return!0}function d(e,t,i,r,s){if(!e)return!1;const n=l(t,i),{coords:a,lengths:u}=e;let o=!1,c=0;for(const l of u)o=h(o,a,n,c,l,r,s),c+=l*n;return o}function h(e,t,i,r,s,n,a){let u=e,o=r;for(let l=r,c=r+s*i;l<c;l+=i){o=l+i,o===c&&(o=r);const e=t[l],s=t[l+1],d=t[o],h=t[o+1];(s<a&&h>=a||h<a&&s>=a)&&e+(a-s)/(h-s)*(d-e)<n&&(u=!u)}return u}var f=i(41801),p=i(99867),y=i(95876),m=i(77270);const g="feature-store:unsupported-query",x={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:null},_={esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},S={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},I={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1};function F(e){return!0===_[e]}function b(e){return!0===S[(0,u.Ji)(e)]}function R(e){return!0===I[e]}function v(e,t,r,s,o){if((0,u.oU)(t)&&"esriGeometryPoint"===r&&("esriSpatialRelIntersects"===e||"esriSpatialRelContains"===e)){const e=(0,f.Uy)(new p.Z,t,!1,!1);return Promise.resolve(t=>function(e,t,i,r){return d(e,!1,!1,r.coords[0],r.coords[1])}(e,0,0,t))}if((0,u.oU)(t)&&"esriGeometryMultipoint"===r){const i=(0,f.Uy)(new p.Z,t,!1,!1);if("esriSpatialRelContains"===e)return Promise.resolve(e=>c(i,!1,!1,e,s,o))}if((0,u.YX)(t)&&"esriGeometryPoint"===r&&("esriSpatialRelIntersects"===e||"esriSpatialRelContains"===e))return Promise.resolve(e=>(0,n.aV)(t,(0,m.Op)(r,s,o,e)));if((0,u.YX)(t)&&"esriGeometryMultipoint"===r&&"esriSpatialRelContains"===e)return Promise.resolve(e=>(0,n.lQ)(t,(0,m.Op)(r,s,o,e)));if((0,u.YX)(t)&&"esriSpatialRelIntersects"===e){const e=function(e){return"mesh"===e?a.h_:(0,a.IY)(e)}(r);return Promise.resolve(i=>e(t,(0,m.Op)(r,s,o,i)))}return Promise.all([i.e(9677),i.e(8592),i.e(9899)]).then(i.bind(i,29899)).then(i=>{const n=i[x[e]].bind(null,t.spatialReference,t);return e=>n((0,m.Op)(r,s,o,e))})}function w(e,t,i){return A.apply(this,arguments)}function A(){return(A=(0,r.Z)(function*(e,t,i){const{spatialRel:r,geometry:n}=e;if(n){if(!F(r))throw new s.Z(g,"Unsupported query spatial relationship",{query:e});if((0,o.JY)(n.spatialReference)&&(0,o.JY)(i)){if(!b(n))throw new s.Z(g,"Unsupported query geometry type",{query:e});if(!R(t))throw new s.Z(g,"Unsupported layer geometry type",{query:e});if(e.outSR)return(0,y._W)(e.geometry&&e.geometry.spatialReference,e.outSR)}}})).apply(this,arguments)}function Q(e){if((0,u.YX)(e))return!0;if((0,u.oU)(e)){for(const t of e.rings){if(5!==t.length)return!1;if(t[0][0]!==t[1][0]||t[0][0]!==t[4][0]||t[2][0]!==t[3][0]||t[0][1]!==t[3][1]||t[0][1]!==t[4][1]||t[1][1]!==t[2][1])return!1}return!0}return!1}},32931:(e,t,i)=>{"use strict";function r(e,t){if(!e)return null;const i=t.featureAdapter,{startTimeField:r,endTimeField:s}=e;let n=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY;if(r&&s)t.forEach(e=>{const t=i.getAttribute(e,r),u=i.getAttribute(e,s);null==t||isNaN(t)||(n=Math.min(n,t)),null==u||isNaN(u)||(a=Math.max(a,u))});else{const e=r||s;t.forEach(t=>{const r=i.getAttribute(t,e);null==r||isNaN(r)||(n=Math.min(n,r),a=Math.max(a,r))})}return{start:n,end:a}}function s(e,t,i){if(!t||!e)return null;const{startTimeField:r,endTimeField:s}=e;if(!r&&!s)return null;const{start:n,end:a}=t;return null===n&&null===a?null:void 0===n&&void 0===a?()=>!1:r&&s?function(e,t,i,r,s){return null!=r&&null!=s?n=>{const a=e.getAttribute(n,t),u=e.getAttribute(n,i);return(null==a||a<=s)&&(null==u||u>=r)}:null!=r?t=>{const s=e.getAttribute(t,i);return null==s||s>=r}:null!=s?i=>{const r=e.getAttribute(i,t);return null==r||r<=s}:void 0}(i,r,s,n,a):function(e,t,i,r){return null!=i&&null!=r&&i===r?r=>e.getAttribute(r,t)===i:null!=i&&null!=r?s=>{const n=e.getAttribute(s,t);return n>=i&&n<=r}:null!=i?r=>e.getAttribute(r,t)>=i:null!=r?i=>e.getAttribute(i,t)<=r:void 0}(i,r||s,n,a)}i.d(t,{R:()=>r,y:()=>s})},77270:(e,t,i)=>{"use strict";i.d(t,{vF:()=>y,S2:()=>C,Op:()=>I,Up:()=>F,j6:()=>R,EG:()=>S});var r=i(16304),s=i(5902),n=i(54704),a=i(43899),u=i(62786),o=i(60337),l=i(11909),c=i(73507),d=i(41801),h=i(99867),f=i(95876);const p=new s.Xn({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),y=Object.freeze({}),m=new h.Z,g=new h.Z,x=new h.Z,_={esriGeometryPoint:d.fQ,esriGeometryPolyline:d.J6,esriGeometryPolygon:d.eG,esriGeometryMultipoint:d.Iv};function S(e,t,i,r=e.hasZ,s=e.hasM){if((0,n.Wi)(t))return null;const a=e.hasZ&&r,u=e.hasM&&s;if(i){const n=(0,d.Nh)(x,t,e.hasZ,e.hasM,"esriGeometryPoint",i,r,s);return(0,d.fQ)(n,a,u)}return(0,d.fQ)(t,a,u)}function I(e,t,i,r,s,a,u=t,o=i){const l=t&&u,c=i&&o,h=(0,n.pC)(r)?"coords"in r?r:r.geometry:null;if((0,n.Wi)(h))return null;if(s){let r=(0,d.zj)(g,h,t,i,e,s,u,o);return a&&(r=(0,d.Nh)(x,r,l,c,e,a)),_[e](r,l,c)}if(a){const r=(0,d.Nh)(x,h,t,i,e,a,u,o);return _[e](r,l,c)}return(0,d.hY)(m,h,t,i,u,o),_[e](m,l,c)}function F(e,t,i){return b.apply(this,arguments)}function b(){return(b=(0,r.Z)(function*(e,t,i){const{outFields:r,orderByFields:s,groupByFieldsForStatistics:n,outStatistics:a}=e;if(r)for(let u=0;u<r.length;u++)r[u]=r[u].trim();if(s)for(let u=0;u<s.length;u++)s[u]=s[u].trim();if(n)for(let u=0;u<n.length;u++)n[u]=n[u].trim();if(a)for(let u=0;u<a.length;u++)a[u].onStatisticField&&(a[u].onStatisticField=a[u].onStatisticField.trim());return e.geometry&&!e.outSR&&(e.outSR=e.geometry.spatialReference),R(e,t,i)})).apply(this,arguments)}function R(e,t,i){return v.apply(this,arguments)}function v(){return(v=(0,r.Z)(function*(e,t,i){if(!e)return null;let{where:r}=e;if(e.where=r=r&&r.trim(),(!r||/^1 *= *1$/.test(r)||t&&t===r)&&(e.where=null),!e.geometry)return e;let s=yield w(e);if(e.distance=0,e.units=null,"esriSpatialRelEnvelopeIntersects"===e.spatialRel){const{spatialReference:t}=e.geometry;s=(0,u.aO)(s),s.spatialReference=t}e.geometry=s,yield(0,f._W)(s.spatialReference,i);const a=(yield(0,l.aX)((0,o.im)(s)))[0];if((0,n.Wi)(a))throw y;const c=a.toJSON(),d=yield(0,f.iV)(c,c.spatialReference,i);if(!d)throw y;return d.spatialReference=i,e.geometry=d,e})).apply(this,arguments)}function w(e){return A.apply(this,arguments)}function A(){return(A=(0,r.Z)(function*(e){const{geometry:t,distance:i,units:r}=e;if(null==i||"vertexAttributes"in t)return t;const s=t.spatialReference,n=r?p.fromJSON(r):(0,a.qE)(s),u=s&&((0,c.sT)(s)||(0,c.sS)(s))?t:yield(0,f._W)(s,c.Zn).then(()=>(0,f.iV)(t,c.Zn));return(yield Q())(u.spatialReference,u,i,n)})).apply(this,arguments)}function Q(){return T.apply(this,arguments)}function T(){return(T=(0,r.Z)(function*(){return(yield Promise.all([i.e(9677),i.e(8592),i.e(9899)]).then(i.bind(i,29899))).geodesicBuffer})).apply(this,arguments)}function C(e){return e&&P in e?JSON.parse(JSON.stringify(e,E)):e}const P="_geVersion",E=(e,t)=>e!==P?t:void 0},58466:(e,t,i)=>{"use strict";function r(e){return!(null!=e.normalizationField||null!=e.normalizationType||null!=e.minValue||null!=e.maxValue||e.sqlExpression&&e.supportsSQLExpression)}function s(e){const t=e.returnDistinct?[...new Set(e.values)]:e.values,i=t.filter(e=>null!=e).length,r={count:i};return e.supportsNullCount&&(r.nullcount=t.length-i),r}function n(e){const{values:t,useSampleStdDev:i,supportsNullCount:r}=e;let s=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY,a=null,u=null,o=null,l=null,c=0;const d=null==e.minValue?-1/0:e.minValue,h=null==e.maxValue?1/0:e.maxValue;for(const p of t)Number.isFinite(p)?p>=d&&p<=h&&(a+=p,s=Math.min(s,p),n=Math.max(n,p),c++):"string"==typeof p&&c++;if(c&&null!=a){u=a/c;let e=0;for(const i of t)Number.isFinite(i)&&i>=d&&i<=h&&(e+=(i-u)**2);l=i?c>1?e/(c-1):0:c>0?e/c:0,o=Math.sqrt(l)}else s=null,n=null;const f={avg:u,count:c,max:n,min:s,stddev:o,sum:a,variance:l};return r&&(f.nullcount=t.length-c),f}function a(e,t){return t?(["avg","stddev","variance"].forEach(t=>{null!=e[t]&&(e[t]=Math.ceil(e[t]))}),e):e}function u(e,t,i,r){let s=null;switch(t){case"log":0!==e&&(s=Math.log(e)*Math.LOG10E);break;case"percent-of-total":Number.isFinite(r)&&0!==r&&(s=e/r*100);break;case"field":Number.isFinite(i)&&0!==i&&(s=e/i);break;case"natural-log":e>0&&(s=Math.log(e));break;case"square-root":e>0&&(s=e**.5)}return s}i.d(t,{i5:()=>n,H0:()=>s,fk:()=>u,S5:()=>r,rt:()=>a}),i(2747),i(21550)}}]);